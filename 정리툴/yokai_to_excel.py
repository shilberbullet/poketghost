# 사용자가 새로 추가한 텍스트를 포함한 전체 요괴 데이터로 다시 엑셀 생성

import pandas as pd
from openpyxl import Workbook
from openpyxl.worksheet.table import Table, TableStyleInfo
from openpyxl.styles import PatternFill
from openpyxl.utils.dataframe import dataframe_to_rows

# 텍스트 데이터
extended_text = '''
 
# 일반 요괴
도깨비,MONSTER,200,150,180,170,밤에 나타나 사람들을 놀라게 하지만 가끔씩 도움을 주기도 한다.,불꽃치기;지옥불;맹화;가시돌진;사념의박치기;강철꼬리치기;몸통박치기;번개
태자귀,GHOST,120,90,120,110,원한을 품고 저승을 떠도는 무서운 원귀. 확률적으로 강력한 일격을 가하는 특성을 지녔다.,천연두;울음소리;복화술;염매
총각귀신,GHOST,130,110,110,120,죽지 못하고 떠도는 처절한 원귀 강한 물리 공격과 방어력 저하 기술을 사용한다.,메치기;포효;위압;버티기
처녀귀신,GHOST,140,100,100,110,불행한 죽음으로 원한 가득한 처녀귀신. 할퀴기와 공격력 및 방어력 저하 스킬이 특징이다.,할퀴기;비명;공포;원한의 바람
구미호,ANIMAL,140,80,100,150,매혹적인 외모와 여우불로 적을 홀리는 구미호는 변신술과 흡생 능력을 지닌 전설의 요괴다.,매혹;할퀴기;간 빼먹기;둔갑술
망태 할아버지,HUMAN,100,110,130,120,밤마다 어린이를 납치해 망태에 넣는다는 무서운 전설의 주인공 인간형에게 특히 위협적이다.,납치;민첩한 걸음;그물 던지기;
돌진천마,ANIMAL,110,100,110,150,옥황상제가 타던 신성한 천마. 하늘을 달리며 전장을 누비고 아군에게 희망을 안겨주는 존재.,천상 질주;신광 충돌;포효하는 발굽;하늘의 응답
마귀,EVIL_SPIRIT,125,95,100,130,형체도 불분명한 사악한 기운의 집합체. 조용히 상대의 정신을 갉아먹는 공포의 존재.,혼령 착취;서늘한 시선;틈 속의 손;영혼 긁기
굴각,GHOST,105,90,110,145,호랑이에 기생한 창귀. 조용히 숨어들었다가 그림자처럼 적을 덮친다.,먹이 유인;그림자 할퀴기;잠복;도주 시도
이올,GHOST,120,85,105,140,적의 기척을 지우며 은밀하게 다가드는 창귀. 방해와 회피에 특화되어 있다.,함정 해체;은신 이동;이빨 찍기;기척 지우기
산적귀,GHOST,130,100,120,100,무리를 지어 길목을 지키는 악귀. 지나가는 이의 물건을 빼앗고 목숨까지 노리기도 한다.,돌던지기;후려치기;맹렬한 후려치기;몸통박치기;정신집중;돌무더기 던지기
독각귀,MONSTER,120,110,130,100,몸에서 독이 흘러내리는 괴수. 날카로운 뿔로 찌르면 깊이 중독된다.,맹독침;극독침;가시돌진;광폭의 가시돌진;물기;깨물어부수기
달귀,TYPE_EVIL_SPIRIT,120,110,100,140,어둠 속에 숨어드는 악귀. 달빛을 피해 그림자에 깃들어 사람의 혼을 갉아먹는다.,잠복;어둠의 손;기척 지우기;그림자 할퀴기;정신집중;속삭임
바람노루,TYPE_ANIMAL,125,90,135,115,바람처럼 빠르게 움직이는 노루 요괴로 풀잎과 함께 달리며 적의 눈에 잘 띄지 않는다,은신 이동;기척 지우기;몸통박치기;맹렬한 몸통박치기;돌던지기;정신집중;
처녀목귀,TYPE_GHOST,100,125,120,125,목매달아 죽은 여인의 원혼이 되살아난 귀신으로로 저주와 울음으로 원한을 퍼뜨린다,속삭임;혼란의 울부짖음;공포;영혼 압박;파열음파;정신집중;
산치성,TYPE_MONSTER,140,130,105,115,깊은 산속에서 태어난 땅의 괴수로로 큰 돌과 나무를 휘두르며 산을 지키는 수호자처럼 행동한...,후려치기;맹렬한 후려치기;돌던지기;돌무더기 던지기;몸통박치기;분노의주먹;
살음도깨비,TYPE_HUMAN,110,130,120,110,사람의 형상을 한 도깨비로 인간을 흉내내지만 의도를 알 수 없는 불안한 존재,짖기;혼란의 울부짖음;불꽃치기;폭렬 불꽃치기;정신집중;후려치기;
구반귀,TYPE_EVIL_SPIRIT,105,135,115,115,밤마다 구불구불한 산길에서 나타나는 귀으로 길 잃은 자의 그림자를 따라붙는다,잠복;그림자 할퀴기;기척 지우기;속삭임;정신집중;영혼 압박;
누룩귀,TYPE_GHOST,100,130,120,100,오래된 술독 속에서 태어난 원귀로 술기운에 취한 자를 노려 몸과 정신을 마비시킨다,파열음파;혼란의 울부짖음;음파;영혼 압박;후려치기;정신집중
불화살귀,TYPE_MONSTER,140,100,110,120,전장에서 죽은 혼령들이 모여 만들어진 불꽃 요괴로로 불타는 화살처럼 빠르게 적을 꿰뚫는다,불꽃치기;폭렬 불꽃치기;꼬리치기;강철 꼬리치기;정신집중;돌던지기
육혼,GHOST,110,90,110,140,혼령 여섯의 원한이 얽힌 무형의 존재. 이름을 부르며 상대를 저주한다.,이름 부르기;속삭임;어둠의 손;영혼 압박
도깨비불,GHOST,120,90,115,150,도깨비의 장난으로 태어난 불씨. 작지만 끈질기며 접촉한 자의 기력을 태워 없앤다.,화염폭산;불씨 튀기기;따라붙는 불꽃;기력 연소
노구화호,TYPE_ANIMAL,125,110,90,125,늙은 할머니로 둔갑하는 여우 요괴로 노파의 모습이지만 뽀얗고 아름다운 외모로 사람들을 현혹...,불꽃치기;폭렬 불꽃치기;기척 지우기;속삭임;정신집중;
대선사사,TYPE_EVIL_SPIRIT,115,125,95,120,과부에게 꿈 속에서 나타나 희롱하는 마물로 낮에는 여인들이 드나드는 집의 항아리 속에 숨어...,잠복;속삭임;어둠의 손;영혼 압박;정신집중;
도피사의,TYPE_HUMAN,140,85,110,115,도롱이 옷을 거꾸로 입은 사람의 모습을 한 괴물입니다. 두 마리씩 몰려다니며 사람에게 들러...,몸통박치기;맹렬한 몸통박치기;후려치기;맹렬한 후려치기;정신집중;
두두리,TYPE_GHOST,100,130,90,130,신라 고려시대에 숭배받던 목신(木神)입니다. 경주 지역의 토속신으로 추정되며 몽골 침입 이...,음파;파열음파;짖기;혼란의 울부짖음;정신집중;
백제궁인,TYPE_GHOST,120,120,95,135,백제가 멸망할 때 백마강에 투신한 궁녀의 원혼입니다. 소년에게 접근하여 정기를 꾀어내어 자...,속삭임;이빨 찍기;기척 지우기;영혼 압박;정신집중;
수일이참대,TYPE_MONSTER,135,90,95,130,작은 도마뱀 모습을 한 요괴입니다. 칼로 자르면 잘린 부위가 더 커져 이무기의 모습으로 변...,물기;깨물어부수기;가시돌진;광폭의 가시돌진;정신집중;
닷발괴물,TYPE_MONSTER,140,95,90,130,꼬리깃과 부리가 각각 닷 발(약 750cm)에 이르는 거대한 괴물. 새 악어 오리너구리의 ...,몸통박치기;맹렬한 몸통박치기;꼬리치기;강철 꼬리치기;물기;깨물어부수기;
수면요마,GHOST,90,120,100,150,어두운 밤마다 나타나 잠든 사람을 괴롭히는 요마. 꿈과 현실의 경계를 무너뜨린다,수면가루(특수기);음파;파열음파;혼란의 울부짖음;속삭임;정신집중
장자마리,TYPE_EVIL_SPIRIT,120,120,110,100,강릉 지역 도깨비로 풍요와 혼돈을 상징하는 익살스러운 존재입니다.,불꽃치기;죽음의속삭임;지옥불;지옥기운;음파;염력;
그슨새,TYPE_GHOST,130,100,90,120,제주도에서 낮에 혼자 있는 사람을 홀리는 요괴로 말로 막을 수 있습니다.,음파;염력;망령의눈빛;죽음의속삭임;영혼흩뿌리기;분노의주먹;
묘두사,TYPE_ANIMAL,100,110,110,130,고양이 머리를 한 뱀으로 치유의 기운을 내뿜어 신으로 숭배되었습니다.,물기;울부짖기;날개베기;깨물어부수기;유혹하기;날렵한몸놀림;
거구귀,TYPE_EVIL_SPIRIT,110,130,110,110,거대한 입을 지녔으나 뛰어난 인물을 만나면 동자로 변해 돕는 수호 귀신입니다.,후려치기;돌던지기;망령의눈빛;지옥불;지옥기운;음파;
삼두일족응,TYPE_MONSTER,140,90,120,100,머리 셋 다리 하나의 매로 삼재를 물리친다는 의미의 상징적 존재입니다.,날개베기;이단도약;사념의박치기;파괴포효;강철꼬리치기;맹화;
달걀귀신,MONSTER,130,90,140,100,깨진 달걀 껍질에서 태어난 요괴 망가진 형태 주시하며 배회한다.,잠복;먹이유인;파열음파;혼란의울부짖음;영혼긁기;정신집중
두억시니,HUMAN,120,110,130,105,죽음의 진상을 외치며 나타나는 투병자의 원혼이 기승을 부린다.,울음소리;복화술;공포;정신집중;속삭임;어둠의손
새우니,ANIMAL,115,85,120,140,새우처럼 구부러진 몸으로 빠르게 기어다니며 적을 급습한다.,은신이동;기척지우기;가시돌진;먹이유인;잠복;도주시도
저퀴,EVIL_SPIRIT,125,95,110,130,맹렬한 갈기를 휘날리며 분노의 기운을 뿜어낸다.,영혼긁기;강철꼬리치기;사념의박치기;분노의주먹;정신집중;틈속의손
역귀,GHOST,110,100,115,120,뒤틀린 원한이 깃든 몸으로 영혼을 사냥한다.,영혼압박;속삭임;어둠의손;울음소리;파열음파;혼란의울부짖음
손님,EVIL_SPIRIT,135,120,140,115,천연두신의 위엄을 품고 재앙을 불러오는 무서운 신령이다.,천연두;염매;서늘한시선;혼령착취;영혼긁기;틈속의손
몽달귀신,GHOST,125,90,130,110,달빛 아래서 잠 못 이루는 망자 원혼이 방황한다.,속삭임;원한의바람;비명;공포;정신집중;울음소리
설공찬,HUMAN,115,105,120,125,비극적 사랑에 얽힌 백제 시인의 원혼이 노래를 부른다.,복화술;속삭임;정신집중;울음소리;어둠의손;공포
손돌,MONSTER,140,135,150,95,매끄러운 돌로 이루어진 거대한 구체가 땅을 진동시킨다.,강철포식;몸통박치기;돌던지기;후려치기;맹렬한후려치기;정신집중
신기원요,ANIMAL,120,100,125,135,불가사의한 빛을 내며 예지력을 부리는 신비한 요마이다.,염력;지옥기운;속삭임;영혼압박;정신집중;잠복
아랑,GHOST,130,110,115,120,억울하게 죽은 궁녀의 원혼이 울부짖으며 원한을 풀지 못한다.,비명;공포;영혼압박;속삭임;정신집중;울음소리
려여귀,EVIL_SPIRIT,125,95,120,130,전염병의 고통을 퍼뜨리는 무시무시한 전염의 화신이다.,염매;혼령착취;서늘한시선;어둠의손;속삭임;기도
장화홍련,HUMAN,115,120,130,105,자매의 억울함이 불꽃처럼 타올라 원혼이 되어 복수한다.,불꽃치기;지옥불;맹화;원한의바람;정신집중;혼란의울부짖음
적염귀,MONSTER,140,125,135,115,불타는 눈과 살점을 두른 불지옥의 사자처럼 돌진한다.,불꽃치기;폭렬불꽃치기;맹화;강철꼬리치기;몸통박치기;정신집중
지귀,GHOST,115,105,120,130,죽은 자의 지식으로 상대의 약점을 꿰뚫어본다.,영혼긁기;속삭임;염력;공포;원한의바람;정신집중
태봉 궁녀귀신,GHOST,120,100,125,110,궁녀의 원한이 깃들어 은인의 후손을 찾아 헤맨다.,속삭임;울음소리;영혼압박;비명;공포;정신집중
착착귀신,GHOST,110,115,130,120,발소리만 남기고 사라지는 기이한 원혼이다.,잠복;기척지우기;파열음파;혼란의울부짖음;속삭임;정신집중
고관대면,HUMAN,125,135,140,100,죽어서도 높은 지위를 지키려는 옛 관리의 영혼이다.,어둠의손;영혼압박;속삭임;정신집중;울음소리;공포
길달,ANIMAL,115,90,120,140,달빛 아래서 길을 인도하는 구슬 같은 눈을 가진 노루요괴이다.,은신이동;기척지우기;속삭임;정신집중;잠복;도주시도
새타니,MONSTER,135,120,140,125,번개를 부르는 날개로 적진을 가르는 천둥의 사자이다.,번개;천상질주;포효하는발굽;하늘의응답;정신집중;맹화
야광귀,GHOST,120,100,115,130,빛나는 살점을 드러내며 어둠 속에서 빛을 뽐낸다.,그림자할퀴기;기척지우기;속삭임;공포;정신집중;파열음파
어둑시니,EVIL_SPIRIT,125,95,120,130,어둠의 기운을 머금고 사람의 정신을 잡아먹는다.,영혼긁기;사념의박치기;틈속의손;속삭임;정신집중;어둠의손
유엽화,MONSTER,130,110,135,115,숲의 잎사귀로 몸을 감싸 위장하며 적에게 달려든다.,은신이동;가시돌진;먹이유인;맹렬한몸통박치기;정신집중;잠복
이매망량,GHOST,115,100,120,135,어두운 밤길에서 사람 홀리는 요괴,속삭임;영혼압박;음파;파열음파;혼란의울부짖음;정신집중
문경관,EVIL_SPIRIT,120,110,130,100,허공에서 목소리만 들려오는 신비체,속삭임;서늘한시선;염력;기척지우기;어둠의손;영혼긁기
개여시,ANIMAL,130,90,140,120,은밀히 다가와 영혼을 물어뜯는 개구리 몸 요괴,물기;깨물어부수기;잠복;도주시도;혼란의울부짖음;정신집중
거치녀,HUMAN,125,115,135,105,목마른 자에게 접근해 숨통을 조이는 처형자,울음소리;영혼압박;속삭임;공포;원한의바람;정신집중
고수여칠,MONSTER,140,130,120,110,일곱 개의 손톱으로 찢고 훑어내는 괴수,할퀴기;광폭의가시돌진;가시돌진;맹렬한후려치기;깨물어부수기;정신집중
구렁덩덩 선비,EVIL_SPIRIT,115,125,130,95,담비와 어울려 검을 지키는 미친 선비,후려치기;돌던지기;몸통박치기;맹독침;정신집중;속삭임
귀마왕,EVIL_SPIRIT,135,120,140,100,천공을 가르는 마왕의 원혼이 군림한다,지옥불;사념의박치기;영혼착취;염매;틈속의손;정신집중
귀태,GHOST,110,130,125,105,머리 없는 시체에 씌워 퍼트리는 저주마,영혼긁기;속삭임;어둠의손;울음소리;혼란의울부짖음;정신집중
그슨대,MONSTER,140,100,135,115,독을 품은 뼈대만 남은 거대한 식인 골상,맹독침;극독침;가시돌진;광폭의가시돌진;물기;정신집중
금갑장군,HUMAN,130,140,145,90,황금 갑옷 입고 사신을 지휘하는 군장,강철섭취;강철포식;강철꼬리치기;영혼긁기;서늘한시선;정신집중
금돼지,ANIMAL,125,100,140,110,황금빛 살갗에 화염 숨을 품은 야수,불꽃치기;폭렬불꽃치기;맹화;꼬리치기;강철꼬리치기;정신집중
노구화위남,GHOST,115,105,130,120,불꽃에 뒤덮인 노인의 원혼이 분노한다,불꽃치기;지옥불;맹화;혼란의울부짖음;원한의바람;정신집중
노옹화구,MONSTER,140,120,135,115,노인의 혼으로 탄생한 불타는 머리뼈,화염폭산;불씨튀기기;따라붙는불꽃;불꽃치기;정신집중;염력
녹정,MONSTER,135,115,140,105,풀과 이끼로 뒤덮인 친환경 괴수,은신이동;잠복;가시돌진;먹이유인;돌던지기;정신집중
녹족부인,EVIL_SPIRIT,120,130,125,100,초록 뱀발에 홀린 자들을 집어삼킨다,영혼압박;속삭임;어둠의손;혼령착취;정신집중;파열음파
단피몽두,MONSTER,140,90,110,130,꿈속 살점만 골라 먹는 흉포한 괴물,수면가루(특수기);음파;파열음파;혼란의울부짖음;물기;정신집중
망태기 할아버지,HUMAN,100,110,130,120,망태로 어린 영혼을 채워 어둠을 기른다,납치;그물던지기;민첩한걸음;속삭임;울음소리;정신집중
모선출처,ANIMAL,115,95,125,135,떠도는 배 위에서 영혼을 수집하는 괴어,음파;파열음파;영혼압박;물기;돌던지기;정신집중
산귀,EVIL_SPIRIT,125,105,135,105,사찰에 숨어 불공을 빼앗는 속임수 귀신,속삭임;영혼착취;서늘한시선;어둠의손;정신집중;염매
상사석탕,MONSTER,130,120,125,100,사랑의 집착으로 변한 거대한 뱀,할퀴기;맹독침;염매;속삭임;정신집중;영혼압박
선묘,ANIMAL,115,85,120,140,선녀의 혼과 맺어진 사슴 요괴,은신이동;기척지우기;속삭임;둔갑술;혼란의울부짖음;정신집중
소인,MONSTER,140,130,145,95,검을 사랑해 무한 전투를 벌이는 작은 전사,후려치기;돌던지기;맹렬한후려치기;정신집중;몸통박치기;맹화
신지께,GHOST,110,125,120,115,바다의 부름을 전하는 인어 원혼,울음소리;속삭임;영혼압박;바다의응답(특수);정신집중;음파
쌍두사목,MONSTER,140,90,120,100,머리 둘 다리 하나로 하늘을 가르는 용맹,날개베기;이단도약;사념의박치기;파괴포효;강철꼬리치기;정신집중
아기장군,EVIL_SPIRIT,125,115,135,110,공중을 날며 국가를 위협한 신생 전사,메치기;포효;위압;정신집중;영혼압박;사념의박치기
왕신단지,HUMAN,130,120,140,105,왕실의 기운을 품은 성스러운 항아리,복화술;천연두;영혼착취;속삭임;공포;정신집중
우렁각시,HUMAN,120,100,130,115,밥 짓는 집에서 조용히 숨 쉬는 신비손,지옥불;영혼긁기;강철꼬리치기;속삭임;정신집중;파열음파
우와 을,ANIMAL,115,95,125,135,두 갈래 뿔로 불길을 가르는 야수,불꽃치기;폭렬불꽃치기;맹화;꼬리치기;영혼압박;정신집중
의가작수,MONSTER,135,125,140,100,죽은 자를 부활시켜 전투하게 하는 망령장,영혼착취;혼령착취;속삭임;어둠의손;정신집중;염력
인두조수,GHOST,115,100,120,125,열 받은 영혼 불타는 고통 전한다.,불꽃치기;지옥불;혼령착취;영혼긁기;파열음파;원한의바람
연산 물귀신,GHOST,110,90,115,130,아직 풀리지 못한 한 번의 외침이 맴돈다.,울음소리;혼란의울부짖음;속삭임;영혼압박;파열음파;공포
제생요마,MONSTER,130,120,140,105,미쳐 날뛰는 망령 불사를 위한 수확자.,혼령착취;가시돌진;파괴포효;사념의박치기;강철꼬리치기;매혹
죽통미녀,HUMAN,120,105,125,115,죽은 자의 가죽 뒤집어쓴 복수자.,할퀴기;비명;공포;메치기;영혼압박;속삭임
홍난삼녀,GHOST,115,95,120,120,절규하는 자매 원혼이 밤길을 떠돈다.,할퀴기;비명;울음소리;원한의바람;혼란의울부짖음;속삭임
거루,MONSTER,135,110,130,100,사납게 포효하며 온몸에 독을 퍼뜨린다.,맹독침;극독침;포효;영혼긁기;물기;깨물어부수기
거악,EVIL_SPIRIT,125,95,115,130,심연에서 깨어난 악령의 목소리가 울린다.,염매;속삭임;서늘한시선;영혼긁기;원한의바람;틈속의손
거잠,MONSTER,130,105,135,110,잿더미 속에서 솟아오른 불타는 골상이다.,화염폭산;불씨튀기기;따라붙는불꽃;불꽃치기;영혼압박;강철꼬리치기
견상여야록,EVIL_SPIRIT,120,115,125,105,기록에 담긴 저주가 살아 움직인다.,속삭임;죽음의속삭임;염력;공포;영혼긁기;파열음파
경어목야유광,GHOST,115,100,120,115,밤바다 물빛 속에서 환영을 불러낸다.,음파;파열음파;혼란의울부짖음;속삭임;영혼압박;염력
금혈어,MONSTER,140,130,135,95,핏빛 비늘로 적을 관통하는 독어이다.,맹독침;가시돌진;강철꼬리치기;사념의박치기;속삭임;물기
나군파,EVIL_SPIRIT,125,120,130,110,전장에 울려 퍼지는 광기 어린 외침.,포효;영혼착취;사념의박치기;원한의바람;서늘한시선;영혼긁기
나티,ANIMAL,115,90,120,130,끝없이 헤엄치며 적을 교란하는 물귀신이다.,음파;속삭임;영혼압박;기척지우기;혼란의울부짖음;파열음파
대영차,MONSTER,135,125,140,100,거대한 몸으로 대지를 갈라내는 힘을 지녔다.,돌던지기;파괴포효;강철꼬리치기;사념의박치기;영혼긁기;맹독침
매기,ANIMAL,120,100,125,135,통통하게 불어나는 몸집으로 상대를 압도한다.,물기;깨물어부수기;혼란의울부짖음;속삭임;영혼압박;도주시도
묘수좌,GHOST,110,115,120,125,묘지의 수호신으로서 영혼을 심판한다.,울음소리;포효;속삭임;원한의바람;혼령착취;공포
백마,ANIMAL,130,115,135,120,달빛 아래에서 순백의 안개를 일으킨다.,천상질주;하늘의응답;속삭임;은신이동;기척지우기;맹화
보은섬여,GHOST,120,105,125,110,보은 강가에서 맺힌 원혼이 되살아난다.,울음소리;속삭임;영혼압박;원한의바람;공포;혼란의울부짖음
불가사리,MONSTER,140,130,140,90,강철 피부와 불사의 힘으로 죽지 않는 몸을 지녔다,불꽃치기;폭렬불꽃치기;맹화;화염폭산;영혼긁기;파열음파
불개,MONSTER,135,120,130,105,불꽃 같은 털로 적진을 휩쓴다.,불꽃치기;지옥불;맹화;따라붙는불꽃;영혼압박;할퀴기
사비하대어,ANIMAL,120,105,125,115,황금 빛 비늘이 번뜩이며 적을 베어낸다.,날개베기;깨물어부수기;맹렬한후려치기;속삭임;영혼긁기;파열음파
살쾡이 요괴,MONSTER,130,115,135,125,도플갱어처럼 모습을 바꿔 접근한다.,둔갑술;할퀴기;파열음파;속삭임;영혼압박;도주시도
삼족구,MONSTER,140,110,120,100,세 갈래 발톱으로 대지를 쥐어짠다.,날개베기;강철꼬리치기;맹화;사념의박치기;돌던지기;화염폭산
삼족섬,MONSTER,135,125,140,95,세 개의 섬을 떠돌며 저주를 퍼뜨린다.,염력;속삭임;사념의박치기;영혼긁기;공포;파열음파
삼족오,ANIMAL,125,105,130,135,태양의 사자 세 발 달린 환조이다.,화염폭산;하늘의응답;맹화;울음소리;영혼압박;속삭임
신구,GHOST,115,100,120,125,오랜 세월의 원한이 응집된 모래 구슬이다.,속삭임;파열음파;혼란의울부짖음;영혼압박;공포;울음소리
신록,EVIL_SPIRIT,125,115,135,105,초록 빛 생명력이 악령에 스며들었다.,염력;영혼압박;속삭임;혼령착취;기척지우기;파열음파
삼목구,ANIMAL,120,95,125,140,목의 정기로 태어난 나무 뱀이다.,은신이동;잠복;날개베기;물기;영혼압박;강철꼬리치기
성성,EVIL_SPIRIT,130,120,140,100,밤하늘 별빛으로 맺은 수호의 영혼이다.,속삭임;영혼긁기;사념의박치기;공포;염력;영혼압박
수금아,MONSTER,135,110,145,90,뱀과 개구리의 혼합으로 태어난 기이체.,깨물어부수기;물기;가시돌진;맹독침;영혼긁기;도주시도
이수약우,EVIL_SPIRIT,125,90,115,130,치명적 기운으로 재앙을 내리는 백우의 혼령이다.,혼령착취;영혼긁기;파열음파;속삭임;서늘한시선;염매
인면조,ANIMAL,130,85,120,145,사람 얼굴 달린 새가 육감을 이용해 적을 교란한다.,날개베기;은신이동;기척지우기;음파;혼란의울부짖음;정신집중
일촌법사,HUMAN,115,110,130,105,마을을 지키는 수행자의 원혼이 신기를 발휘한다.,복화술;속삭임;영혼압박;울음소리;정신집중;공포
장두사,MONSTER,135,120,140,95,머리 없이 몸만 남겨진 잔혹한 살육의 화신이다.,메치기;강철꼬리치기;맹렬한후려치기;깨물어부수기;영혼긁기;속삭임
조마귀,GHOST,120,100,125,120,달빛 아래 피땀을 흘리며 복수를 다짐하는 원혼이다.,울음소리;공포;원한의바람;속삭임;혼란의울부짖음;영혼압박
지축,MONSTER,140,130,145,90,대지를 뒤흔드는 힘으로 적진을 쓸어버리는 거대 괴수이다.,돌던지기;파괴포효;강철꼬리치기;맹독침;사념의박치기;영혼긁기
천마,ANIMAL,125,100,130,140,천공을 달리는 맹렬한 말 형태의 성스러운 정령이다.,천상질주;하늘의응답;포효하는발굽;속삭임;정신집중;은신이동
청너구리,MONSTER,130,105,135,115,마을의 비밀을 훔치는 교활한 환영의 괴수이다.,은신이동;기척지우기;도주시도;속삭임;영혼긁기;혼란의울부짖음
청단마,ANIMAL,120,90,125,135,청동 빛 갈기를 휘날리며 달리는 신성마이다.,은신이동;천상질주;하늘의응답;속삭임;정신집중;맹화
청색구인,EVIL_SPIRIT,125,115,130,110,푸른 불꽃으로 영혼을 태우는 수호의 악령이다.,불꽃치기;화염폭산;따라붙는불꽃;영혼긁기;속삭임;정신집중
청양,HUMAN,115,120,125,100,청룡의 기운을 받아 청명하게 깨어난 무사의 혼이다.,복화술;후려치기;속삭임;정신집중;울음소리;공포
청우,GHOST,120,100,115,130,먹구름처럼 몰려와 생명을 삼키는 비바람의 정령이다.,음파;파열음파;혼란의울부짖음;속삭임;공포;영혼압박
토두서조,ANIMAL,130,105,140,115,토끼 머리의 새가 밤하늘을 유영하며 수호한다.,날개베기;하늘의응답;은신이동;속삭임;정신집중;맹화
토주원,MONSTER,135,120,145,95,고대 왕릉에 깃든 뼈 도깨비가 부활한 형체이다.,뼈분쇄(대체→깨물어부수기);돌던지기;후려치기;영혼긁기;속삭임;공포
해중조,GHOST,115,100,120,125,바닷속 그리움으로 떠도는 수중의 원혼이다.,울음소리;속삭임;영혼압박;음파;공포;정신집중
호문조,ANIMAL,125,90,130,140,혓바닥처럼 생긴 부리로 적의 의식을 훔친다.,이빨찍기;속삭임;혼란의울부짖음;영혼압박;음파;정신집중
강길,HUMAN,120,110,130,105,전설 속 강가에서 물길을 지키던 수호자의 혼령이다.,복화술;물기;속삭임;영혼압박;정신집중;공포
구렁이 아우,MONSTER,135,115,140,100,두 마리 뱀이 하나로 합쳐진 공포의 환수이다.,물기;가시돌진;강철꼬리치기;영혼긁기;속삭임;파열음파
김녕사굴 구렁이,EVIL_SPIRIT,125,100,135,110,암흑의 동굴 속 맺힌 악한 기운의 화신이다.,혼령착취;어둠의손;속삭임;공포;영혼긁기;틈속의손
계룡,ANIMAL,130,105,135,115,용과 닮은 뿔 달린 짐승이 전장을 호령한다.,날개베기;포효;천상질주;속삭임;정신집중;맹화
능원사,GHOST,115,100,120,130,폐사찰의 기도를 삼킨 공허의 망령이다.,울음소리;속삭임;공포;혼령착취;파열음파;영혼압박
무수대망,EVIL_SPIRIT,130,115,140,105,수많은 원혼을 거느린 혼의 군단장이다.,영혼착취;사념의박치기;속삭임;서늘한시선;파열음파;정신집중
이목룡,MONSTER,140,120,145,90,얼굴이 여섯 개인 용이 대지를 쪼개며 돌진한다.,돌던지기;파괴포효;강철꼬리치기;사념의박치기;영혼긁기;영혼압박
노호정,ANIMAL,125,110,130,115,늙은 호랑이 형상으로 호흡마다 불꽃을 내뿜는다.,불꽃치기;맹화;따라붙는불꽃;울음소리;정신집중;강철꼬리치기
매구,GHOST,115,105,120,135,맹수가 들끓던 자리에 박힌 망령의 분노이다.,포효;울음소리;공포;혼란의울부짖음;속삭임;영혼압박
백여우,ANIMAL,130,95,135,140,아홉 꼬리 대신 구슬 같은 불빛을 내뿜는다.,매혹;둔갑술;은신이동;속삭임;정신집중;혼란의울부짖음
불여우,MONSTER,135,120,140,110,불꽃 꼬리로 적을 감싸 태워버리는 요괴다.,불꽃치기;폭렬불꽃치기;불씨튀기기;혼령착취;영혼긁기;속삭
삼기호신,EVIL_SPIRIT,130,125,140,100,세 방향에서 공격을 가하는 수호룡의 환영이다.,사념의박치기;영혼긁기;속삭임;공포;서늘한시선;영혼압박


'''

# 기술 데이터
skill_data = '''
# 기술 데이터 파일
# 형식: 이름,기술의 상성,공격력,명중률,PP,설명

# 초급 기술
불꽃치기,MONSTER,30,90,20,불꽃으로 적을 공격한다
돌던지기,HUMAN,25,95,25,돌을 던져 적을 공격한다
꼬리치기,ANIMAL,20,100,25,꼬리로 적을 공격한다
물기,ANIMAL,25,90,20,이빨로 적을 물어뜯는다
할퀴기,ANIMAL,25,90,20,날카로운 발톱으로 할퀴어 공격한다
몸통박치기,MONSTER,30,85,20,몸 전체로 부딪혀 공격한다
독침,ANIMAL,20,95,30,독침을 쏘아 공격한다
짖기,ANIMAL,15,100,30,큰 소리로 적의 명중률을 낮춘다
음파,GHOST,25,90,25,강한 음파로 정신 피해를 입힌다
유혹하기,ANIMAL,15,85,30,적을 유혹하여 공격력을 낮춘다
날개베기,ANIMAL,30,90,15,날개를 이용해 회전 베기를 가한다
속임수베기,HUMAN,35,100,10,기습 공격으로반드시 먼저 공격한다
박치기,MONSTER,30,95,15,연속으로 머리로 들이받는다

# 중급 기술
바람칼,HUMAN,35,85,20,바람으로 만든 칼날을 날린다
얼음창,GHOST,40,80,15,얼음으로 만든 창을 던진다
물어뜯기,ANIMAL,35,80,20,이빨로 적을 물어뜯는다
후려치기,HUMAN,35,80,20,무거운 일격으로 적을 가격한다
맹독침,ANIMAL,35,80,20,강한 독을 가진 독침을 쏘아 공격한다
흙폭탄,HUMAN,30,90,20,흙으로 만든 폭탄을 던진다
마구 할퀴기,ANIMAL,40,85,10,연속으로 할퀴어 강한 피해를 준다
염력,GHOST,35,85,20,염력으로 물건을 던져져 공격한다
울부짖기,ANIMAL,20,100,5,자신의 공격력을 증가시킨다
연속박치기,MONSTER,40,80,/15,연속으로 머리로 들이받는다

# 고급 기술
지옥불,EVIL_SPIRIT,50,70,5,지옥의 불꽃으로 적을 태운다
가시돌진,MONSTER,40,85,15,몸의 가시로 돌진하며 상대에게 큰 피해를 준다
분노의주먹,HUMAN,45,80,10,분노를 담아 강한 한 방을 날린다
사념의박치기,MONSTER,50,80,5,강하게 부딪힌다다
강철꼬리치기,MONSTER,45,80,10,단단한 꼬리로 강하게 내리친다
맹화,MONSTER,50,85,5,강한 불꽃으로 공격헌다
깨물어부수기,ANIMAL,40,90,15,이빨로 깨물어 부순다다
번개,GHOST,45,75,10,번개로 적을 공격한다
철퇴내리치기,HUMAN,50,75,5,무거운 철퇴를 휘둘러 큰 피해를 준다
지옥기운,EVIL_SPIRIT,60,65,5,지옥의 어둠으로 적에게 큰 피해를 준다
이단도약,MONSTER,45,85,10,두 번 튕겨 뛰며 큰 피해를 준다
망령의눈빛,GHOST,100,30,5,행동불능으로 만들 확률 30%

# 패러독스 요괴 기술
혼돈의파동,EVIL_SPIRIT,85,90,10,혼돈의 파동으로 적을 공격
차원의칼날,EVIL_SPIRIT,80,95,10,차원의 칼날로 적을 베어버림
어둠의손길,EVIL_SPIRIT,75,100,15,어둠의 손길로 적을 공격
영혼흡수,EVIL_SPIRIT,70,100,15,적의 영혼을 흡수하여 HP 회복
차원방패,EVIL_SPIRIT,0,100,10,차원의 방패로 자신을 보호
파멸의주먹,EVIL_SPIRIT,85,90,10,파멸을 부르는 강력한 주먹
공간왜곡,EVIL_SPIRIT,0,100,5,공간을 왜곡하여 적의 공격을 무효화
수호의외침,EVIL_SPIRIT,0,100,5,강력한 외침으로 자신의 방어력 증가
그림자베기,GHOST,75,95,10,그림자로 적을 베어버림
암흑폭풍,GHOST,80,90,10,암흑의 폭풍으로 적을 공격
속삭임,GHOST,0,100,5,적의 공격력을 낮추는 속삭임
절망의눈빛,GHOST,0,100,5,적을 절망에 빠뜨리는 눈빛
운명베기,HUMAN,80,90,10,운명을 베어버리는 강력한 공격
예지타격,HUMAN,75,95,10,미래를 예지하여 정확한 타격
시간왜곡,HUMAN,0,100,5,시간을 왜곡하여 적의 행동을 봉쇄
심판의칼날,HUMAN,85,85,10,심판의 칼날로 적을 베어버림
시간단절,EVIL_SPIRIT,0,100,5,시간의 흐름을 끊어버림
과거회상,EVIL_SPIRIT,0,100,5,과거의 기억으로 자신을 강화
미래도약,EVIL_SPIRIT,0,100,5,미래로 도약하여 회피
영원의속삭임,EVIL_SPIRIT,0,100,5,영원한 속삭임으로 적을 약화
공허의창,EVIL_SPIRIT,80,90,10,공허의 창으로 적을 관통
무감정공격,EVIL_SPIRIT,75,95,10,감정 없는 공격으로 적을 공격
침묵의포효,EVIL_SPIRIT,0,100,5,침묵의 포효로 적을 약화
무의의손길,EVIL_SPIRIT,70,100,15,무의의 손길로 적을 공격
붕괴의손짓,GHOST,0,100,5,붕괴의 손짓으로 적을 약화
파멸의속삭임,GHOST,0,100,5,파멸의 속삭임으로 적을 공격
무의식공격,GHOST,75,95,10,무의식의 공격으로 적을 공격
종말의울음,GHOST,0,100,5,종말을 알리는 울음으로 적을 약화
경계이동,HUMAN,0,100,5,경계를 이동하여 회피
방랑자의칼날,HUMAN,80,90,10,방랑자의 칼날로 적을 베어버림
이방인의눈,HUMAN,0,100,5,이방인의 눈으로 적을 약화
자유의외침,HUMAN,0,100,5,자유의 외침으로 자신을 강화
환영공격,ANIMAL,75,95,10,환영으로 적을 공격
실체변화,ANIMAL,0,100,5,실체를 변화시켜 회피
환각의포효,ANIMAL,0,100,5,환각의 포효로 적을 혼란
허상의손길,ANIMAL,70,100,15,허상의 손길로 적을 공격

# 최종보스 기술
차원파괴,EVIL_SPIRIT,100,80,5,차원을 파괴하는 강력한 공격
시간지배,EVIL_SPIRIT,90,85,5,시간을 지배하여 적의 행동을 봉쇄
공간지배,EVIL_SPIRIT,95,80,5,공간을 지배하여 적을 압박

'''

# 기술 타입 매핑 딕셔너리 생성
skill_type_map = {}
for line in skill_data.strip().splitlines():
    parts = line.split(",")
    if len(parts) >= 2:
        skill_name = parts[0].strip()
        skill_type = parts[1].strip()
        skill_type_map[skill_name] = skill_type

def parse_yokai_data(text_data):
    """텍스트 형식의 요괴 데이터를 파싱합니다."""
    records = []
    current_kind = "일반"  # 기본값
    for line in text_data.strip().splitlines():
        line = line.strip()
        if not line:
            continue
        if line.startswith('#'):
            if "일반" in line:
                current_kind = "일반"
            elif "보스" in line:
                current_kind = "보스"
            elif "패러독스" in line:
                current_kind = "패러독스"
            elif "최종보스" in line:
                current_kind = "최종보스"
            continue
        
        parts = line.split(",")
        if len(parts) < 7:
            continue
        
        name = parts[0].strip()
        type_ = parts[1].strip().replace("TYPE_", "")
        atk, df, hp, spd = map(int, parts[2:6])
        description = parts[6].strip()
        skills = ",".join(parts[7:]).replace(";", "; ").strip()
        skill_list = [s.strip() for s in skills.split(";") if s.strip()]
        while len(skill_list) < 10:
            skill_list.append("")
        
        # 종족값 계산
        total_stats = atk + df + hp + spd
        
        records.append([name, type_, atk, df, hp, spd, total_stats, description] + skill_list[:10] + [current_kind])
    
    return pd.DataFrame(records, columns=["이름", "타입", "공격력", "방어력", "체력", "스피드", "종족값", "도감설명", 
                                        "기술1", "기술2", "기술3", "기술4", "기술5", "기술6", "기술7", "기술8", "기술9", "기술10", "요괴종류"])

# 중복 제거 및 데이터 정리
unique_records = []
seen = set()
current_kind = "일반"
for line in extended_text.strip().splitlines():
    line = line.strip()
    if not line:
        continue
    if line.startswith('#'):
        if "일반" in line:
            current_kind = "일반"
        elif "보스" in line:
            current_kind = "보스"
        elif "패러독스" in line:
            current_kind = "패러독스"
        elif "최종보스" in line:
            current_kind = "최종보스"
        continue
    parts = line.split(",")
    if len(parts) < 7:
        continue
    name = parts[0].strip()
    type_ = parts[1].strip().replace("TYPE_", "")
    atk, df, hp, spd = map(int, parts[2:6])
    description = parts[6].strip()
    skills = ",".join(parts[7:]).replace(";", "; ").strip()
    skill_list = [s.strip() for s in skills.split(";") if s.strip()]
    while len(skill_list) < 10:
        skill_list.append("")
    # 종족값 계산
    total_stats = atk + df + hp + spd
    key = (name, type_, atk, df, hp, spd, description, tuple(skill_list))
    if key not in seen:
        seen.add(key)
        unique_records.append([name, type_, atk, df, hp, spd, total_stats, description] + skill_list[:10] + [current_kind])

# DataFrame 생성 (기술1~10 컬럼 추가)
df = pd.DataFrame(unique_records, columns=["이름", "타입", "공격력", "방어력", "체력", "스피드", "종족값", "도감설명", "기술1", "기술2", "기술3", "기술4", "기술5", "기술6", "기술7", "기술8", "기술9", "기술10", "요괴종류"])

# 타입별 색상 지정
type_colors = {
    "EVIL_SPIRIT": "FF9999",
    "GHOST": "CC99FF",
    "MONSTER": "FFFF99",
    "HUMAN": "66CCCC",
    "ANIMAL": "99CC99",
}

# 요괴종류별 색상 지정
yokai_kind_colors = {
    "일반": "FFFFFF",      # 흰색
    "보스": "FFFACD",      # 연노랑
    "패러독스": "E6E6FA",  # 연보라
    "최종보스": "FFB6C1",  # 연빨강
}

# 워크북 구성
wb = Workbook()

# 요괴 도감 시트
ws_yokai = wb.active
ws_yokai.title = "요괴 도감"

# 데이터 입력
for r in dataframe_to_rows(df, index=False, header=True):
    ws_yokai.append(r)

# 테이블 생성
table = Table(displayName="Table1", ref=f"A1:S{len(df)+1}")
style = TableStyleInfo(name="TableStyleMedium9", showFirstColumn=False,
                      showLastColumn=False, showRowStripes=True, showColumnStripes=False)
table.tableStyleInfo = style
ws_yokai.add_table(table)

# 타입 색상 적용 (타입 컬럼)
for row in ws_yokai.iter_rows(min_row=2, max_row=ws_yokai.max_row, min_col=2, max_col=2):
    for cell in row:
        color = type_colors.get(cell.value, None)
        if color:
            cell.fill = PatternFill(start_color=color, end_color=color, fill_type="solid")

# 기술별 색상 적용 (기술1~10 컬럼)
for col in range(8, 18):  # 기술1~10 컬럼
    for row in ws_yokai.iter_rows(min_row=2, max_row=ws_yokai.max_row, min_col=col, max_col=col):
        for cell in row:
            if cell.value:
                skill_type = skill_type_map.get(cell.value, None)
                if skill_type:
                    color = type_colors.get(skill_type, None)
                    if color:
                        cell.fill = PatternFill(start_color=color, end_color=color, fill_type="solid")

# 요괴종류 색상 적용 (요괴종류 컬럼)
for row in ws_yokai.iter_rows(min_row=2, max_row=ws_yokai.max_row, min_col=19, max_col=19):
    for cell in row:
        color = yokai_kind_colors.get(cell.value, None)
        if color:
            cell.fill = PatternFill(start_color=color, end_color=color, fill_type="solid")

# 열 너비 자동 조정
for column in ws_yokai.columns:
    max_length = 0
    column = [cell for cell in column]
    for cell in column:
        try:
            if len(str(cell.value)) > max_length:
                max_length = len(str(cell.value))
        except:
            pass
    adjusted_width = (max_length + 2)
    ws_yokai.column_dimensions[column[0].column_letter].width = adjusted_width

# 파일 저장
wb.save("요괴_도감.xlsx")
print("엑셀 파일이 요괴_도감.xlsx에 저장되었습니다.")
