import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import PatternFill, Font
from openpyxl.worksheet.table import Table, TableStyleInfo
from openpyxl.utils.dataframe import dataframe_to_rows

def parse_yokai_data(text_data):
    """텍스트 형식의 요괴 데이터를 파싱합니다."""
    records = []
    for line in text_data.strip().splitlines():
        line = line.strip()
        if not line:
            continue
        if line.startswith('#'):
            continue
        
        parts = line.split(",")
        if len(parts) < 7:
            continue
        
        name = parts[0].strip()
        type_ = parts[1].strip().replace("TYPE_", "")
        atk, df, hp, spd = map(int, parts[2:6])
        description = parts[6].strip()
        skills = ",".join(parts[7:]).replace(";", "; ").strip()
        skill_list = [s.strip() for s in skills.split(";") if s.strip()]
        while len(skill_list) < 10:
            skill_list.append("")
        
        records.append([name, type_, atk, df, hp, spd, description] + skill_list[:10])
    
    return pd.DataFrame(records, columns=["이름", "타입", "공격력", "방어력", "체력", "스피드", "도감설명", 
                                        "기술1", "기술2", "기술3", "기술4", "기술5", "기술6", "기술7", "기술8", "기술9", "기술10"])

def compare_yokai(df1, df2):
    """두 요괴 모음을 비교하여 차이점을 찾습니다."""
    # 이름을 기준으로 병합
    merged = pd.merge(df1, df2, on='이름', how='outer', suffixes=('_1', '_2'))
    
    # 차이점이 있는 행만 필터링
    differences = []
    for _, row in merged.iterrows():
        # 첫 번째 데이터에만 있는 요괴 (삭제됨)
        if pd.isna(row['타입_2']):
            diff = {
                '이름': row['이름'],
                '상태': '삭제됨',
                '타입': row['타입_1'],
                '공격력': row['공격력_1'],
                '방어력': row['방어력_1'],
                '체력': row['체력_1'],
                '스피드': row['스피드_1'],
                '도감설명': row['도감설명_1'],
                '기술1': row['기술1_1'],
                '기술2': row['기술2_1'],
                '기술3': row['기술3_1'],
                '기술4': row['기술4_1'],
                '기술5': row['기술5_1'],
                '기술6': row['기술6_1'],
                '기술7': row['기술7_1'],
                '기술8': row['기술8_1'],
                '기술9': row['기술9_1'],
                '기술10': row['기술10_1']
            }
            differences.append(diff)
        
        # 두 번째 데이터에만 있는 요괴 (추가됨)
        elif pd.isna(row['타입_1']):
            diff = {
                '이름': row['이름'],
                '상태': '추가됨',
                '타입': row['타입_2'],
                '공격력': row['공격력_2'],
                '방어력': row['방어력_2'],
                '체력': row['체력_2'],
                '스피드': row['스피드_2'],
                '도감설명': row['도감설명_2'],
                '기술1': row['기술1_2'],
                '기술2': row['기술2_2'],
                '기술3': row['기술3_2'],
                '기술4': row['기술4_2'],
                '기술5': row['기술5_2'],
                '기술6': row['기술6_2'],
                '기술7': row['기술7_2'],
                '기술8': row['기술8_2'],
                '기술9': row['기술9_2'],
                '기술10': row['기술10_2']
            }
            differences.append(diff)
        
        # 두 데이터 모두에 있는 요괴 (변경됨)
        else:
            changed = False
            diff = {
                '이름': row['이름'],
                '상태': '변경됨',
                '타입': row['타입_2'],
                '공격력': row['공격력_2'],
                '방어력': row['방어력_2'],
                '체력': row['체력_2'],
                '스피드': row['스피드_2'],
                '도감설명': row['도감설명_2'],
                '기술1': row['기술1_2'],
                '기술2': row['기술2_2'],
                '기술3': row['기술3_2'],
                '기술4': row['기술4_2'],
                '기술5': row['기술5_2'],
                '기술6': row['기술6_2'],
                '기술7': row['기술7_2'],
                '기술8': row['기술8_2'],
                '기술9': row['기술9_2'],
                '기술10': row['기술10_2']
            }
            
            # 변경 사항 확인
            for col in ['타입', '공격력', '방어력', '체력', '스피드', '도감설명']:
                if row[f'{col}_1'] != row[f'{col}_2']:
                    changed = True
                    break
            
            for i in range(1, 11):
                if row[f'기술{i}_1'] != row[f'기술{i}_2']:
                    changed = True
                    break
            
            if changed:
                differences.append(diff)
    
    return pd.DataFrame(differences)

def save_to_excel(df, output_path):
    """비교 결과를 엑셀 파일로 저장합니다."""
    wb = Workbook()
    ws = wb.active
    ws.title = "요괴 비교 결과"
    
    # 데이터 입력
    for r in dataframe_to_rows(df, index=False, header=True):
        ws.append(r)
    
    # 색상 지정
    added_fill = PatternFill(start_color="92D050", end_color="92D050", fill_type="solid")  # 초록색
    deleted_fill = PatternFill(start_color="FF0000", end_color="FF0000", fill_type="solid")  # 빨간색
    changed_fill = PatternFill(start_color="FFEB9C", end_color="FFEB9C", fill_type="solid")  # 노란색
    
    # 상태에 따른 색상 적용
    for row in ws.iter_rows(min_row=2, max_row=ws.max_row):
        status = row[1].value  # 상태는 두 번째 열
        if status == "추가됨":
            for cell in row:
                cell.fill = added_fill
        elif status == "삭제됨":
            for cell in row:
                cell.fill = deleted_fill
        elif status == "변경됨":
            for cell in row:
                cell.fill = changed_fill
    
    # 열 너비 자동 조정
    for column in ws.columns:
        max_length = 0
        column_letter = column[0].column_letter
        for cell in column:
            try:
                if len(str(cell.value)) > max_length:
                    max_length = len(str(cell.value))
            except:
                pass
        adjusted_width = (max_length + 2)
        ws.column_dimensions[column_letter].width = adjusted_width
    
    # 테이블 스타일 설정 (기술10열까지 포함)
    tab = Table(displayName="Table1", ref=f"A1:R{ws.max_row}")  # R열(기술10)까지 포함
    style = TableStyleInfo(name="TableStyleMedium9", showFirstColumn=False,
                          showLastColumn=False, showRowStripes=True, showColumnStripes=False)
    tab.tableStyleInfo = style
    ws.add_table(tab)
    
    # 파일 저장
    wb.save(output_path)
    print(f"비교 결과가 {output_path}에 저장되었습니다.")

def main():
    # 첫 번째 요괴 데이터
    text1 = """#  태자귀,GHOST,120,90,120,110,원한을 품고 저승을 떠도는 무서운 원귀. 확률적으로 강력한 일격을 가하는 특성을 지녔다.,천연두;울음소리;복화술;염매
총각귀신,GHOST,130,110,110,120,죽지 못하고 떠도는 처절한 원귀 강한 물리 공격과 방어력 저하 기술을 사용한다.,메치기;포효;위압;버티기
처녀귀신,GHOST,140,100,100,110,불행한 죽음으로 원한 가득한 처녀귀신. 할퀴기와 공격력 및 방어력 저하 스킬이 특징이다.,할퀴기;비명;공포;원한의 바람
구미호,ANIMAL,140,80,100,150,매혹적인 외모와 여우불로 적을 홀리는 구미호는 변신술과 흡생 능력을 지닌 전설의 요괴다.,매혹;할퀴기;간 빼먹기;둔갑술
망태 할아버지,HUMAN,100,110,130,120,밤마다 어린이를 납치해 망태에 넣는다는 무서운 전설의 주인공 인간형에게 특히 위협적이다.,납치;민첩한 걸음;그물 던지기;
돌진천마,ANIMAL,110,100,110,150,옥황상제가 타던 신성한 천마. 하늘을 달리며 전장을 누비고 아군에게 희망을 안겨주는 존재.,천상 질주;신광 충돌;포효하는 발굽;하늘의 응답
마귀,EVIL_SPIRIT,125,95,100,130,형체도 불분명한 사악한 기운의 집합체. 조용히 상대의 정신을 갉아먹는 공포의 존재.,혼령 착취;서늘한 시선;틈 속의 손;영혼 긁기
불가살이,MONSTER,135,135,145,75,강철 피부와 불사의 힘으로 죽지 않는 몸을 지녔다. 물리 공격을 받을수록 더 강해지는 무시무시한 괴수.,강철 섭취;무쇠 손톱;강철 피부;불사의 포효;강철 포식
굴각,GHOST,105,90,110,145,호랑이에 기생한 창귀. 조용히 숨어들었다가 그림자처럼 적을 덮친다.,먹이 유인;그림자 할퀴기;잠복;도주 시도
이올,GHOST,120,85,105,140,적의 기척을 지우며 은밀하게 다가드는 창귀. 방해와 회피에 특화되어 있다.,함정 해체;은신 이동;이빨 찍기;기척 지우기
산적귀,GHOST,130,100,120,100,무리를 지어 길목을 지키는 악귀. 지나가는 이의 물건을 빼앗고 목숨까지 노리기도 한다.,돌던지기;후려치기;맹렬한 후려치기;몸통박치기;정신집중;돌무더기 던지기
독각귀,MONSTER,120,110,130,100,몸에서 독이 흘러내리는 괴수. 날카로운 뿔로 찌르면 깊이 중독된다.,맹독침;극독침;가시돌진;광폭의 가시돌진;물기;깨물어부수기
달귀,TYPE_EVIL_SPIRIT,120,110,100,140,어둠 속에 숨어드는 악귀. 달빛을 피해 그림자에 깃들어 사람의 혼을 갉아먹는다.,잠복;어둠의 손;기척 지우기;그림자 할퀴기;정신집중;속삭임
바람노루,TYPE_ANIMAL,125,90,135,115,바람처럼 빠르게 움직이는 노루 요괴로 풀잎과 함께 달리며 적의 눈에 잘 띄지 않는다,은신 이동;기척 지우기;몸통박치기;맹렬한 몸통박치기;돌던지기;정신집중;
처녀목귀,TYPE_GHOST,100,125,120,125,목매달아 죽은 여인의 원혼이 되살아난 귀신으로로 저주와 울음으로 원한을 퍼뜨린다,속삭임;혼란의 울부짖음;공포;영혼 압박;파열음파;정신집중;
산치성,TYPE_MONSTER,140,130,105,115,깊은 산속에서 태어난 땅의 괴수로로 큰 돌과 나무를 휘두르며 산을 지키는 수호자처럼 행동한다,후려치기;맹렬한 후려치기;돌던지기;돌무더기 던지기;몸통박치기;분노의주먹;
살음도깨비,TYPE_HUMAN,110,130,120,110,사람의 형상을 한 도깨비로 인간을 흉내내지만 의도를 알 수 없는 불안한 존재,짖기;혼란의 울부짖음;불꽃치기;폭렬 불꽃치기;정신집중;후려치기;
구반귀,TYPE_EVIL_SPIRIT,105,135,115,115,밤마다 구불구불한 산길에서 나타나는 귀으로 길 잃은 자의 그림자를 따라붙는다,잠복;그림자 할퀴기;기척 지우기;속삭임;정신집중;영혼 압박;
누룩귀,TYPE_GHOST,100,130,120,100,오래된 술독 속에서 태어난 원귀로 술기운에 취한 자를 노려 몸과 정신을 마비시킨다,파열음파;혼란의 울부짖음;음파;영혼 압박;후려치기;정신집중
불화살귀,TYPE_MONSTER,140,100,110,120,전장에서 죽은 혼령들이 모여 만들어진 불꽃 요괴로로 불타는 화살처럼 빠르게 적을 꿰뚫는다,불꽃치기;폭렬 불꽃치기;꼬리치기;강철 꼬리치기;정신집중;돌던지기
수면요마,GHOST,90,120,100,150,어두운 밤마다 나타나 잠든 사람을 괴롭히는 요마로 꿈과 현실의 경계를 무너뜨린다,수면가루(특수기);음파;파열음파;혼란의 울부짖음;속삭임;정신집중
육혼,GHOST,110,90,110,140,혼령 여섯의 원한이 얽힌 무형의 존재. 이름을 부르며 상대를 저주한다.,이름 부르기;속삭임;어둠의 손;영혼 압박
도깨비불,GHOST,120,90,115,150,도깨비의 장난으로 태어난 불씨. 작지만 끈질기며 접촉한 자의 기력을 태워 없앤다.,화염폭산;불씨 튀기기;따라붙는 불꽃;기력 연소
노구화호,TYPE_ANIMAL,125,110,90,125,늙은 할머니로 둔갑하는 여우 요괴로 노파의 모습이지만 뽀얗고 아름다운 외모로 사람들을 현혹한다. 501년 백제에서 자주 목격되었다는 기록이 있다,불꽃치기;폭렬 불꽃치기;기척 지우기;속삭임;정신집중;
대선사사,TYPE_EVIL_SPIRIT,115,125,95,120,과부에게 꿈 속에서 나타나 희롱하는 마물로 낮에는 여인들이 드나드는 집의 항아리 속에 숨어 지낸낸다,잠복;속삭임;어둠의 손;영혼 압박;정신집중;
도피사의,TYPE_HUMAN,140,85,110,115,도롱이 옷을 거꾸로 입은 사람의 모습을 한 괴물입니다. 두 마리씩 몰려다니며 사람에게 들러붙어 체온을 높여 죽인다,몸통박치기;맹렬한 몸통박치기;후려치기;맹렬한 후려치기;정신집중;
두두리,TYPE_GHOST,100,130,90,130,신라 고려시대에 숭배받던 목신(木神)입니다. 경주 지역의 토속신으로 추정되며 몽골 침입 이후 신앙이 소멸된 것으로 보입니다.,음파;파열음파;짖기;혼란의 울부짖음;정신집중;
백제궁인,TYPE_GHOST,120,120,95,135,백제가 멸망할 때 백마강에 투신한 궁녀의 원혼입니다. 소년에게 접근하여 정기를 꾀어내어 자신의 기운을 보충하려 합니다,속삭임;이빨 찍기;기척 지우기;영혼 압박;정신집중;
수일이참대,TYPE_MONSTER,135,90,95,130,작은 도마뱀 모습을 한 요괴입니다. 칼로 자르면 잘린 부위가 더 커져 이무기의 모습으로 변한다고 합니다,물기;깨물어부수기;가시돌진;광폭의 가시돌진;정신집중;
닷발괴물,TYPE_MONSTER,140,95,90,130,꼬리깃과 부리가 각각 닷 발(약 750cm)에 이르는 거대한 괴물. 새 악어 오리너구리의 특징을 지닌 기괴한 형상으로 종종 가족을 납치하거나 잡아먹는다. 복수한 주인공에게 가마솥에 삶겨 죽고 그 가루가 벼룩이나 모기로 환생해 다시 인간을 괴롭힌다고 전해진다,몸통박치기;맹렬한 몸통박치기;꼬리치기;강철 꼬리치기;물기;깨물어부수기;
수면요마,GHOST,90,120,100,150,어두운 밤마다 나타나 잠든 사람을 괴롭히는 요마. 꿈과 현실의 경계를 무너뜨린다,수면가루(특수기);음파;파열음파;혼란의 울부짖음;속삭임;정신집중
장자마리,TYPE_EVIL_SPIRIT,120,120,110,100,강릉 지역 도깨비로 풍요와 혼돈을 상징하는 익살스러운 존재입니다.,불꽃치기;죽음의속삭임;지옥불;지옥기운;음파;염력;
그슨새,TYPE_GHOST,130,100,90,120,제주도에서 낮에 혼자 있는 사람을 홀리는 요괴로 말로 막을 수 있습니다.,음파;염력;망령의눈빛;죽음의속삭임;영혼흩뿌리기;분노의주먹;
묘두사,TYPE_ANIMAL,100,110,110,130,고양이 머리를 한 뱀으로 치유의 기운을 내뿜어 신으로 숭배되었습니다.,물기;울부짖기;날개베기;깨물어부수기;유혹하기;날렵한몸놀림;
거구귀,TYPE_EVIL_SPIRIT,110,130,110,110,거대한 입을 지녔으나 뛰어난 인물을 만나면 동자로 변해 돕는 수호 귀신입니다.,후려치기;돌던지기;망령의눈빛;지옥불;지옥기운;음파;
삼두일족응,TYPE_MONSTER,140,90,120,100,머리 셋 다리 하나의 매로 삼재를 물리친다는 의미의 상징적 존재입니다.,날개베기;이단도약;사념의박치기;파괴포효;강철꼬리치기;맹화;"""

    # 두 번째 요괴 데이터
    text2 = """# 도깨비,MONSTER,200,150,180,170,밤에 나타나 사람들을 놀라게 하지만 가끔씩 도움을 주기도 한다.,불꽃치기;지옥불;맹화;가시돌진;사념의박치기;강철꼬리치기;몸통박치기;번개
태자귀,GHOST,120,90,120,110,원한을 품고 저승을 떠도는 무서운 원귀. 확률적으로 강력한 일격을 가하는 특성을 지녔다.,천연두;울음소리;복화술;염매
총각귀신,GHOST,130,110,110,120,죽지 못하고 떠도는 처절한 원귀 강한 물리 공격과 방어력 저하 기술을 사용한다.,메치기;포효;위압;버티기
처녀귀신,GHOST,140,100,100,110,불행한 죽음으로 원한 가득한 처녀귀신. 할퀴기와 공격력 및 방어력 저하 스킬이 특징이다.,할퀴기;비명;공포;원한의 바람
구미호,ANIMAL,140,80,100,150,매혹적인 외모와 여우불로 적을 홀리는 구미호는 변신술과 흡생 능력을 지닌 전설의 요괴다.,매혹;할퀴기;간 빼먹기;둔갑술
망태 할아버지,HUMAN,100,110,130,120,밤마다 어린이를 납치해 망태에 넣는다는 무서운 전설의 주인공 인간형에게 특히 위협적이다.,납치;민첩한 걸음;그물 던지기;
돌진천마,ANIMAL,110,100,110,150,옥황상제가 타던 신성한 천마. 하늘을 달리며 전장을 누비고 아군에게 희망을 안겨주는 존재.,천상 질주;신광 충돌;포효하는 발굽;하늘의 응답
마귀,EVIL_SPIRIT,125,95,100,130,형체도 불분명한 사악한 기운의 집합체. 조용히 상대의 정신을 갉아먹는 공포의 존재.,혼령 착취;서늘한 시선;틈 속의 손;영혼 긁기
불가살이,MONSTER,135,135,145,75,강철 피부와 불사의 힘으로 죽지 않는 몸을 지녔다. 물리 공격을 받을수록 더 강해지는 무시...,강철 섭취;무쇠 손톱;강철 피부;불사의 포효;강철 포식
굴각,GHOST,105,90,110,145,호랑이에 기생한 창귀. 조용히 숨어들었다가 그림자처럼 적을 덮친다.,먹이 유인;그림자 할퀴기;잠복;도주 시도
이올,GHOST,120,85,105,140,적의 기척을 지우며 은밀하게 다가드는 창귀. 방해와 회피에 특화되어 있다.,함정 해체;은신 이동;이빨 찍기;기척 지우기
산적귀,GHOST,130,100,120,100,무리를 지어 길목을 지키는 악귀. 지나가는 이의 물건을 빼앗고 목숨까지 노리기도 한다.,돌던지기;후려치기;맹렬한 후려치기;몸통박치기;정신집중;돌무더기 던지기
독각귀,MONSTER,120,110,130,100,몸에서 독이 흘러내리는 괴수. 날카로운 뿔로 찌르면 깊이 중독된다.,맹독침;극독침;가시돌진;광폭의 가시돌진;물기;깨물어부수기
달귀,TYPE_EVIL_SPIRIT,120,110,100,140,어둠 속에 숨어드는 악귀. 달빛을 피해 그림자에 깃들어 사람의 혼을 갉아먹는다.,잠복;어둠의 손;기척 지우기;그림자 할퀴기;정신집중;속삭임
바람노루,TYPE_ANIMAL,125,90,135,115,바람처럼 빠르게 움직이는 노루 요괴로 풀잎과 함께 달리며 적의 눈에 잘 띄지 않는다,은신 이동;기척 지우기;몸통박치기;맹렬한 몸통박치기;돌던지기;정신집중;
처녀목귀,TYPE_GHOST,100,125,120,125,목매달아 죽은 여인의 원혼이 되살아난 귀신으로로 저주와 울음으로 원한을 퍼뜨린다,속삭임;혼란의 울부짖음;공포;영혼 압박;파열음파;정신집중;
산치성,TYPE_MONSTER,140,130,105,115,깊은 산속에서 태어난 땅의 괴수로로 큰 돌과 나무를 휘두르며 산을 지키는 수호자처럼 행동한...,후려치기;맹렬한 후려치기;돌던지기;돌무더기 던지기;몸통박치기;분노의주먹;
살음도깨비,TYPE_HUMAN,110,130,120,110,사람의 형상을 한 도깨비로 인간을 흉내내지만 의도를 알 수 없는 불안한 존재,짖기;혼란의 울부짖음;불꽃치기;폭렬 불꽃치기;정신집중;후려치기;
구반귀,TYPE_EVIL_SPIRIT,105,135,115,115,밤마다 구불구불한 산길에서 나타나는 귀으로 길 잃은 자의 그림자를 따라붙는다,잠복;그림자 할퀴기;기척 지우기;속삭임;정신집중;영혼 압박;
누룩귀,TYPE_GHOST,100,130,120,100,오래된 술독 속에서 태어난 원귀로 술기운에 취한 자를 노려 몸과 정신을 마비시킨다,파열음파;혼란의 울부짖음;음파;영혼 압박;후려치기;정신집중
불화살귀,TYPE_MONSTER,140,100,110,120,전장에서 죽은 혼령들이 모여 만들어진 불꽃 요괴로로 불타는 화살처럼 빠르게 적을 꿰뚫는다,불꽃치기;폭렬 불꽃치기;꼬리치기;강철 꼬리치기;정신집중;돌던지기
수면요마,GHOST,90,120,100,150,어두운 밤마다 나타나 잠든 사람을 괴롭히는 요마로 꿈과 현실의 경계를 무너뜨린다,수면가루(특수기);음파;파열음파;혼란의 울부짖음;속삭임;정신집중
육혼,GHOST,110,90,110,140,혼령 여섯의 원한이 얽힌 무형의 존재. 이름을 부르며 상대를 저주한다.,이름 부르기;속삭임;어둠의 손;영혼 압박
도깨비불,GHOST,120,90,115,150,도깨비의 장난으로 태어난 불씨. 작지만 끈질기며 접촉한 자의 기력을 태워 없앤다.,화염폭산;불씨 튀기기;따라붙는 불꽃;기력 연소
노구화호,TYPE_ANIMAL,125,110,90,125,늙은 할머니로 둔갑하는 여우 요괴로 노파의 모습이지만 뽀얗고 아름다운 외모로 사람들을 현혹...,불꽃치기;폭렬 불꽃치기;기척 지우기;속삭임;정신집중;
대선사사,TYPE_EVIL_SPIRIT,115,125,95,120,과부에게 꿈 속에서 나타나 희롱하는 마물로 낮에는 여인들이 드나드는 집의 항아리 속에 숨어...,잠복;속삭임;어둠의 손;영혼 압박;정신집중;
도피사의,TYPE_HUMAN,140,85,110,115,도롱이 옷을 거꾸로 입은 사람의 모습을 한 괴물입니다. 두 마리씩 몰려다니며 사람에게 들러...,몸통박치기;맹렬한 몸통박치기;후려치기;맹렬한 후려치기;정신집중;
두두리,TYPE_GHOST,100,130,90,130,신라 고려시대에 숭배받던 목신(木神)입니다. 경주 지역의 토속신으로 추정되며 몽골 침입 이...,음파;파열음파;짖기;혼란의 울부짖음;정신집중;
백제궁인,TYPE_GHOST,120,120,95,135,백제가 멸망할 때 백마강에 투신한 궁녀의 원혼입니다. 소년에게 접근하여 정기를 꾀어내어 자...,속삭임;이빨 찍기;기척 지우기;영혼 압박;정신집중;
수일이참대,TYPE_MONSTER,135,90,95,130,작은 도마뱀 모습을 한 요괴입니다. 칼로 자르면 잘린 부위가 더 커져 이무기의 모습으로 변...,물기;깨물어부수기;가시돌진;광폭의 가시돌진;정신집중;
닷발괴물,TYPE_MONSTER,140,95,90,130,꼬리깃과 부리가 각각 닷 발(약 750cm)에 이르는 거대한 괴물. 새 악어 오리너구리의 ...,몸통박치기;맹렬한 몸통박치기;꼬리치기;강철 꼬리치기;물기;깨물어부수기;
수면요마,GHOST,90,120,100,150,어두운 밤마다 나타나 잠든 사람을 괴롭히는 요마. 꿈과 현실의 경계를 무너뜨린다,수면가루(특수기);음파;파열음파;혼란의 울부짖음;속삭임;정신집중
장자마리,TYPE_EVIL_SPIRIT,120,120,110,100,강릉 지역 도깨비로 풍요와 혼돈을 상징하는 익살스러운 존재입니다.,불꽃치기;죽음의속삭임;지옥불;지옥기운;음파;염력;
그슨새,TYPE_GHOST,130,100,90,120,제주도에서 낮에 혼자 있는 사람을 홀리는 요괴로 말로 막을 수 있습니다.,음파;염력;망령의눈빛;죽음의속삭임;영혼흩뿌리기;분노의주먹;
묘두사,TYPE_ANIMAL,100,110,110,130,고양이 머리를 한 뱀으로 치유의 기운을 내뿜어 신으로 숭배되었습니다.,물기;울부짖기;날개베기;깨물어부수기;유혹하기;날렵한몸놀림;
거구귀,TYPE_EVIL_SPIRIT,110,130,110,110,거대한 입을 지녔으나 뛰어난 인물을 만나면 동자로 변해 돕는 수호 귀신입니다.,후려치기;돌던지기;망령의눈빛;지옥불;지옥기운;음파;
삼두일족응,TYPE_MONSTER,140,90,120,100,머리 셋 다리 하나의 매로 삼재를 물리친다는 의미의 상징적 존재입니다.,날개베기;이단도약;사념의박치기;파괴포효;강철꼬리치기;맹화; """

    # 데이터 파싱
    df1 = parse_yokai_data(text1)
    df2 = parse_yokai_data(text2)
    
    # 비교
    result_df = compare_yokai(df1, df2)
    
    # 결과 저장
    save_to_excel(result_df, "요괴_비교_결과.xlsx")

if __name__ == "__main__":
    main() 