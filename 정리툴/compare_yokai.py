import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import PatternFill, Font
from openpyxl.worksheet.table import Table, TableStyleInfo
from openpyxl.utils.dataframe import dataframe_to_rows

def parse_yokai_data(text_data):
    """텍스트 형식의 요괴 데이터를 파싱합니다."""
    records = []
    for line in text_data.strip().splitlines():
        line = line.strip()
        if not line:
            continue
        if line.startswith('#'):
            continue
        
        parts = line.split(",")
        if len(parts) < 7:
            continue
        
        name = parts[0].strip()
        type_ = parts[1].strip().replace("TYPE_", "")
        atk, df, hp, spd = map(int, parts[2:6])
        description = parts[6].strip()
        skills = ",".join(parts[7:]).replace(";", "; ").strip()
        skill_list = [s.strip() for s in skills.split(";") if s.strip()]
        while len(skill_list) < 10:
            skill_list.append("")
        
        records.append([name, type_, atk, df, hp, spd, description] + skill_list[:10])
    
    return pd.DataFrame(records, columns=["이름", "타입", "공격력", "방어력", "체력", "스피드", "도감설명", 
                                        "기술1", "기술2", "기술3", "기술4", "기술5", "기술6", "기술7", "기술8", "기술9", "기술10"])

def compare_yokai(df1, df2):
    """두 요괴 모음을 비교하여 차이점을 찾습니다."""
    # 이름을 기준으로 병합
    merged = pd.merge(df1, df2, on='이름', how='outer', suffixes=('_1', '_2'))
    
    # 차이점이 있는 행만 필터링
    differences = []
    for _, row in merged.iterrows():
        # 첫 번째 데이터에만 있는 요괴 (삭제됨)
        if pd.isna(row['타입_2']):
            diff = {
                '이름': row['이름'],
                '상태': '삭제됨',
                '타입': row['타입_1'],
                '공격력': row['공격력_1'],
                '방어력': row['방어력_1'],
                '체력': row['체력_1'],
                '스피드': row['스피드_1'],
                '도감설명': row['도감설명_1'],
                '기술1': row['기술1_1'],
                '기술2': row['기술2_1'],
                '기술3': row['기술3_1'],
                '기술4': row['기술4_1'],
                '기술5': row['기술5_1'],
                '기술6': row['기술6_1'],
                '기술7': row['기술7_1'],
                '기술8': row['기술8_1'],
                '기술9': row['기술9_1'],
                '기술10': row['기술10_1']
            }
            differences.append(diff)
        
        # 두 번째 데이터에만 있는 요괴 (추가됨)
        elif pd.isna(row['타입_1']):
            diff = {
                '이름': row['이름'],
                '상태': '추가됨',
                '타입': row['타입_2'],
                '공격력': row['공격력_2'],
                '방어력': row['방어력_2'],
                '체력': row['체력_2'],
                '스피드': row['스피드_2'],
                '도감설명': row['도감설명_2'],
                '기술1': row['기술1_2'],
                '기술2': row['기술2_2'],
                '기술3': row['기술3_2'],
                '기술4': row['기술4_2'],
                '기술5': row['기술5_2'],
                '기술6': row['기술6_2'],
                '기술7': row['기술7_2'],
                '기술8': row['기술8_2'],
                '기술9': row['기술9_2'],
                '기술10': row['기술10_2']
            }
            differences.append(diff)
        
        # 두 데이터 모두에 있는 요괴 (변경됨)
        else:
            changed = False
            diff = {
                '이름': row['이름'],
                '상태': '변경됨',
                '타입': row['타입_2'],
                '공격력': row['공격력_2'],
                '방어력': row['방어력_2'],
                '체력': row['체력_2'],
                '스피드': row['스피드_2'],
                '도감설명': row['도감설명_2'],
                '기술1': row['기술1_2'],
                '기술2': row['기술2_2'],
                '기술3': row['기술3_2'],
                '기술4': row['기술4_2'],
                '기술5': row['기술5_2'],
                '기술6': row['기술6_2'],
                '기술7': row['기술7_2'],
                '기술8': row['기술8_2'],
                '기술9': row['기술9_2'],
                '기술10': row['기술10_2']
            }
            
            # 변경 사항 확인
            for col in ['타입', '공격력', '방어력', '체력', '스피드', '도감설명']:
                if row[f'{col}_1'] != row[f'{col}_2']:
                    changed = True
                    break
            
            for i in range(1, 11):
                if row[f'기술{i}_1'] != row[f'기술{i}_2']:
                    changed = True
                    break
            
            if changed:
                differences.append(diff)
    
    return pd.DataFrame(differences)

def save_to_excel(df, output_path):
    """비교 결과를 엑셀 파일로 저장합니다."""
    wb = Workbook()
    ws = wb.active
    ws.title = "요괴 비교 결과"
    
    # 데이터 입력
    for r in dataframe_to_rows(df, index=False, header=True):
        ws.append(r)
    
    # 색상 지정
    added_fill = PatternFill(start_color="92D050", end_color="92D050", fill_type="solid")  # 초록색
    deleted_fill = PatternFill(start_color="FF0000", end_color="FF0000", fill_type="solid")  # 빨간색
    changed_fill = PatternFill(start_color="FFEB9C", end_color="FFEB9C", fill_type="solid")  # 노란색
    
    # 상태에 따른 색상 적용
    for row in ws.iter_rows(min_row=2, max_row=ws.max_row):
        status = row[1].value  # 상태는 두 번째 열
        if status == "추가됨":
            for cell in row:
                cell.fill = added_fill
        elif status == "삭제됨":
            for cell in row:
                cell.fill = deleted_fill
        elif status == "변경됨":
            for cell in row:
                cell.fill = changed_fill
    
    # 열 너비 자동 조정
    for column in ws.columns:
        max_length = 0
        column_letter = column[0].column_letter
        for cell in column:
            try:
                if len(str(cell.value)) > max_length:
                    max_length = len(str(cell.value))
            except:
                pass
        adjusted_width = (max_length + 2)
        ws.column_dimensions[column_letter].width = adjusted_width
    
    # 테이블 스타일 설정 (기술10열까지 포함)
    tab = Table(displayName="Table1", ref=f"A1:R{ws.max_row}")  # R열(기술10)까지 포함
    style = TableStyleInfo(name="TableStyleMedium9", showFirstColumn=False,
                          showLastColumn=False, showRowStripes=True, showColumnStripes=False)
    tab.tableStyleInfo = style
    ws.add_table(tab)
    
    # 파일 저장
    wb.save(output_path)
    print(f"비교 결과가 {output_path}에 저장되었습니다.")

def main():
    # 첫 번째 요괴 데이터
    text1 = """
# 요괴 데이터 파일
# 형식: 이름,타입,공격력,방어력,체력,스피드,도감설명,기술1;기술2;...

총각귀신,GHOST,130,110,110,120,죽지 못하고 떠도는 처절한 원귀 강한 물리 공격과 방어력 저하 기술을 사용한다,메치기;짖기;위압;버티기
태봉 궁녀귀신,GHOST,120,100,125,110,궁녀의 원한이 깃들어 은인의 후손을 찾아 헤맨다,새벽의속삭임;소리지르기;영혼압박;비명;괴성;정신집중
태자귀,GHOST,120,90,120,110,원한을 품고 저승을 떠도는 무서운 원귀로 확률적으로 강력한 일격을 가하는 특성을 지녔다,천연두;소리지르기;복화술;염매
해중조,GHOST,115,100,120,125,바닷속 그리움으로 떠도는 수중의 원혼이다,소리지르기;새벽의속삭임;영혼압박;음파;괴성;정신집중
홍난삼녀,GHOST,115,95,120,120,절규하는 자매 원혼이 밤길을 떠돈다,할퀴기;비명;소리지르기;원한의바람;괴성공명;새벽의속삭임
개여시,ANIMAL,130,90,140,120,은밀히 다가와 영혼을 물어뜯는 개구리 몸 요괴,물기;깨물어부수기;잠복;도주시도;괴성공명;정신집중
계룡,ANIMAL,130,105,135,115,용과 닮은 뿔 달린 짐승이 전장을 호령한다,날개베기;짖기;천상질주;새벽의속삭임;정신집중;맹화
구미호,ANIMAL,140,80,100,150,매혹적인 외모와 여우불로 적을 홀리는 구미호는 변신술과 흡생 능력을 지닌 전설의 요괴다,매혹;할퀴기;백호의울음;둔갑술
금돼지,ANIMAL,125,100,140,110,황금빛 살갗에 화염 숨을 품은 야수,불꽃치기;불길장벽;맹화;꼬리치기;강철꼬리치기;정신집중
길달,ANIMAL,115,90,120,140,달빛 아래서 길을 인도하는 구슬 같은 눈을 가진 노루요괴이다,은신이동;기척지우기;새벽의속삭임;정신집중;잠복;도주시도
나티,ANIMAL,115,90,120,130,끝없이 헤엄치며 적을 교란하는 물귀신이다,음파;새벽의속삭임;영혼압박;기척지우기;괴성공명;폭음파
노구화호,ANIMAL,125,110,90,125,늙은 할머니로 둔갑하는 여우 요괴로 노파의 모습이지만 뽀얗고 아름다운 외모로 사람들을 현혹한다다,불꽃치기;폭렬 불꽃치기;기척 지우기;새벽의속삭임;정신집중;
노호정,ANIMAL,125,110,130,115,늙은 호랑이 형상으로 호흡마다 불꽃을 내뿜는다,불꽃치기;맹화;따라붙는불꽃;소리지르기;정신집중;강철꼬리치기
돌진천마,ANIMAL,110,100,110,150,옥황상제가 타던 신성한 천마로 하늘을 달리며 전장을 누비고 아군에게 희망을 안겨주는 존재,천상 질주;신광 충돌;포효하는발굽;하늘의 응답
매기,ANIMAL,120,100,125,135,통통하게 불어나는 몸집으로 상대를 압도한다,물기;깨물어부수기;괴성공명;새벽의속삭임;영혼압박;도주시도
모선출처,ANIMAL,115,95,125,135,떠도는 배 위에서 영혼을 수집하는 괴어,음파;폭음파;영혼압박;물기;돌던지기;정신집중
묘두사,ANIMAL,100,110,110,130,고양이 머리를 한 뱀으로 치유의 기운을 내뿜어 신으로 숭배되었습니다,물기;울부짖기;날개베기;깨물어부수기;유혹하기;날렵한몸놀림;
바람노루,ANIMAL,125,90,135,115,바람처럼 빠르게 움직이는 노루 요괴로 풀잎과 함께 달리며 적의 눈에 잘 띄지 않는다,은신 이동;기척 지우기;몸통박치기;맹렬한 몸통박치기;돌던지기;정신집중;
백마,ANIMAL,130,115,135,120,달빛 아래에서 순백의 안개를 일으킨다,천상질주;하늘의응답;새벽의속삭임;은신이동;기척지우기;맹화
백여우,ANIMAL,130,95,135,140,아홉 꼬리 대신 구슬 같은 불빛을 내뿜는다,매혹;둔갑술;은신이동;새벽의속삭임;정신집중;괴성공명
사비하대어,ANIMAL,120,105,125,115,황금 빛 비늘이 번뜩이며 적을 베어낸다,날개베기;깨물어부수기;맹렬한후려치기;새벽의속삭임;망령의눈빛;폭음파
삼목구,ANIMAL,120,95,125,140,목의 정기로 태어난 나무 뱀이다,은신이동;잠복;날개베기;물기;영혼압박;강철꼬리치기
삼족오,ANIMAL,125,105,130,135,태양의 사자 세 발 달린 환조이다,용암분출;하늘의응답;맹화;소리지르기;영혼압박;새벽의속삭임
새우니,ANIMAL,115,85,120,140,새우처럼 구부러진 몸으로 빠르게 기어다니며 적을 급습한다,은신이동;기척지우기;가시돌진;먹이유인;잠복;도주시도
선묘,ANIMAL,115,85,120,140,선녀의 혼과 맺어진 사슴 요괴,은신이동;기척지우기;새벽의속삭임;둔갑술;괴성공명;정신집중
신기원요,ANIMAL,120,100,125,135,불가사의한 빛을 내며 예지력을 부리는 신비한 요마이다,염력;지옥기운;새벽의속삭임;영혼압박;정신집중;잠복
우와 을,ANIMAL,115,95,125,135,두 갈래 뿔로 불길을 가르는 야수,불꽃치기;불길장벽;맹화;꼬리치기;영혼압박;정신집중
인면조,ANIMAL,130,85,120,145,사람 얼굴 달린 새가 육감을 이용해 적을 교란한다,날개베기;은신이동;기척지우기;음파;괴성공명;정신집중
천마,ANIMAL,125,100,130,140,천공을 달리는 맹렬한 말 형태의 성스러운 정령이다,천상질주;하늘의응답;포효하는발굽;새벽의속삭임;정신집중;은신이동
청단마,ANIMAL,120,90,125,135,청동 빛 갈기를 휘날리며 달리는 신성마이다,은신이동;천상질주;하늘의응답;새벽의속삭임;정신집중;맹화
토두서조,ANIMAL,130,105,140,115,토끼 머리의 새가 밤하늘을 유영하며 수호한다,날개베기;하늘의응답;은신이동;새벽의속삭임;정신집중;맹화
호문조,ANIMAL,125,90,130,140,혓바닥처럼 생긴 부리로 적의 의식을 훔친다,이빨찍기;새벽의속삭임;괴성공명;영혼압박;음파;정신집중
강길,HUMAN,120,110,130,105,전설 속 강가에서 물길을 지키던 수호자의 혼령이다,복화술;물기;새벽의속삭임;영혼압박;정신집중;괴성
거치녀,HUMAN,125,115,135,105,목마른 자에게 접근해 숨통을 조이는 처형자,소리지르기;영혼압박;새벽의속삭임;괴성;원한의바람;정신집중
고관대면,HUMAN,125,135,140,100,죽어서도 높은 지위를 지키려는 옛 관리의 영혼이다,어둠의손;영혼압박;새벽의속삭임;정신집중;소리지르기;괴성
금갑장군,HUMAN,130,140,145,90,황금 갑옷 입고 사신을 지휘하는 군장,강철섭취;강철포식;강철꼬리치기;망령의눈빛;서늘한시선;정신집중
도피사의,HUMAN,140,85,110,115,도롱이 옷을 거꾸로 입은 사람의 모습을 한 괴물입니다 두 마리씩 몰려다니며 사람에게 들러붙는다다,몸통박치기;맹렬한 몸통박치기;후려치기;맹렬한 후려치기;정신집중;
두억시니,HUMAN,120,110,130,105,죽음의 진상을 외치며 나타나는 투병자의 원혼이 기승을 부린다,소리지르기;복화술;괴성;정신집중;새벽의속삭임;어둠의손
망태 할아버지,HUMAN,100,110,130,120,밤마다 어린이를 납치해 망태에 넣는다는 무서운 전설의 주인공 인간형에게 특히 위협적이다,납치;민첩한 걸음;그물 던지기;
망태기 할아버지,HUMAN,100,110,130,120,망태로 어린 영혼을 채워 어둠을 기른다,납치;그물던지기;민첩한걸음;새벽의속삭임;소리지르기;정신집중
살음도깨비,HUMAN,110,130,120,110,사람의 형상을 한 도깨비로 인간을 흉내내지만 의도를 알 수 없는 불안한 존재,짖기;혼란의 울부짖음;불꽃치기;폭렬 불꽃치기;정신집중;후려치기;
설공찬,HUMAN,115,105,120,125,비극적 사랑에 얽힌 백제 시인의 원혼이 노래를 부른다,복화술;새벽의속삭임;정신집중;소리지르기;어둠의손;괴성
왕신단지,HUMAN,130,120,140,105,왕실의 기운을 품은 성스러운 항아리,복화술;천연두;영혼착취;새벽의속삭임;괴성;정신집중
우렁각시,HUMAN,120,100,130,115,밥 짓는 집에서 조용히 숨 쉬는 신비손,지옥불;망령의눈빛;강철꼬리치기;새벽의속삭임;정신집중;폭음파
일촌법사,HUMAN,115,110,130,105,마을을 지키는 수행자의 원혼이 신기를 발휘한다,복화술;새벽의속삭임;영혼압박;소리지르기;정신집중;괴성
장화홍련,HUMAN,115,120,130,105,자매의 억울함이 불꽃처럼 타올라 원혼이 되어 복수한다,불꽃치기;지옥불;맹화;원한의바람;정신집중;괴성공명
죽통미녀,HUMAN,120,105,125,115,죽은 자의 가죽 뒤집어쓴 복수자,할퀴기;비명;괴성;메치기;영혼압박;새벽의속삭임
청양,HUMAN,115,120,125,100,청룡의 기운을 받아 청명하게 깨어난 무사의 혼이다,복화술;후려치기;새벽의속삭임;정신집중;소리지르기;괴성
거구귀,EVIL_SPIRIT,110,130,110,110,거대한 입을 지녔으나 뛰어난 인물을 만나면 동자로 변해 돕는 수호 귀신입니다,후려치기;돌던지기;망령의눈빛;지옥불;지옥기운;음파;
거악,EVIL_SPIRIT,125,95,115,130,심연에서 깨어난 악령의 목소리가 울린다,염매;새벽의속삭임;서늘한시선;망령의눈빛;원한의바람;틈속의손
견상여야록,EVIL_SPIRIT,120,115,125,105,기록에 담긴 저주가 살아 움직인다,새벽의속삭임;지옥기운;염력;괴성;망령의눈빛;폭음파
구렁덩덩 선비,EVIL_SPIRIT,115,125,130,95,담비와 어울려 검을 지키는 미친 선비,후려치기;돌던지기;몸통박치기;맹독침;정신집중;새벽의속삭임
구반귀,EVIL_SPIRIT,105,135,115,115,밤마다 구불구불한 산길에서 나타나는 귀으로 길 잃은 자의 그림자를 따라붙는다,잠복;그림자 할퀴기;기척 지우기;새벽의속삭임;정신집중;영혼 압박;
귀마왕,EVIL_SPIRIT,135,120,140,100,천공을 가르는 마왕의 원혼이 군림한다,지옥불;사념의박치기;영혼착취;염매;틈속의손;정신집중
김녕사굴 구렁이,EVIL_SPIRIT,125,100,135,110,암흑의 동굴 속 맺힌 악한 기운의 화신이다,혼령메아리;어둠의손;새벽의속삭임;괴성;망령의눈빛;틈속의손
나군파,EVIL_SPIRIT,125,120,130,110,전장에 울려 퍼지는 광기 어린 외침,짖기;영혼착취;사념의박치기;원한의바람;서늘한시선;망령의눈빛
녹족부인,EVIL_SPIRIT,120,130,125,100,초록 뱀발에 홀린 자들을 집어삼킨다,영혼압박;새벽의속삭임;어둠의손;혼령메아리;정신집중;폭음파
달귀,EVIL_SPIRIT,120,110,100,140,어둠 속에 숨어드는 악귀로 달빛을 피해 그림자에 깃들어 사람의 혼을 갉아먹는다,잠복;어둠의 손;기척 지우기;그림자 할퀴기;정신집중;새벽의속삭임
대선사사,EVIL_SPIRIT,115,125,95,120,과부에게 꿈 속에서 나타나 희롱하는 마물로 낮에는 여인들이 드나드는 집의 항아리 속에 숨어있는다다,잠복;새벽의속삭임;어둠의 손;영혼 압박;정신집중;
려여귀,EVIL_SPIRIT,125,95,120,130,전염병의 고통을 퍼뜨리는 무시무시한 전염의 화신이다,염매;혼령메아리;서늘한시선;어둠의손;새벽의속삭임;기도
마귀,EVIL_SPIRIT,125,95,100,130,형체도 불분명한 사악한 기운의 집합체 조용히 상대의 정신을 갉아먹는 괴성의 존재,혼령 착취;서늘한 시선;틈 속의 손;영혼 긁기
무수대망,EVIL_SPIRIT,130,115,140,105,수많은 원혼을 거느린 혼의 군단장이다,영혼착취;사념의박치기;새벽의속삭임;서늘한시선;폭음파;정신집중
문경관,EVIL_SPIRIT,120,110,130,100,허공에서 목소리만 들려오는 신비체,새벽의속삭임;서늘한시선;염력;기척지우기;어둠의손;망령의눈빛
산귀,EVIL_SPIRIT,125,105,135,105,사찰에 숨어 불공을 빼앗는 속임수 귀신,새벽의속삭임;영혼착취;서늘한시선;어둠의손;정신집중;염매
삼기호신,EVIL_SPIRIT,130,125,140,100,세 방향에서 공격을 가하는 수호룡의 환영이다,사념의박치기;망령의눈빛;새벽의속삭임;괴성;서늘한시선;영혼압박
성성,EVIL_SPIRIT,130,120,140,100,밤하늘 별빛으로 맺은 수호의 영혼이다,새벽의속삭임;망령의눈빛;사념의박치기;괴성;염력;영혼압박
손님,EVIL_SPIRIT,135,120,140,115,천연두신의 위엄을 품고 재앙을 불러오는 무서운 신령이다,천연두;염매;서늘한시선;혼령메아리;망령의눈빛;틈속의손
신록,EVIL_SPIRIT,125,115,135,105,초록 빛 생명력이 악령에 스며들었다,염력;영혼압박;새벽의속삭임;혼령메아리;기척지우기;폭음파
아기장군,EVIL_SPIRIT,125,115,135,110,공중을 날며 국가를 위협한 신생 전사,메치기;짖기;위압;정신집중;영혼압박;사념의박치기
어둑시니,EVIL_SPIRIT,125,95,120,130,어둠의 기운을 머금고 사람의 정신을 잡아먹는다,망령의눈빛;사념의박치기;틈속의손;새벽의속삭임;정신집중;어둠의손
이수약우,EVIL_SPIRIT,125,90,115,130,치명적 기운으로 재앙을 내리는 백우의 혼령이다,혼령메아리;망령의눈빛;폭음파;새벽의속삭임;서늘한시선;염매
장자마리,EVIL_SPIRIT,120,120,110,100,강릉 지역 도깨비로 풍요와 혼돈을 상징하는 익살스러운 존재입니다,불꽃치기;지옥기운;지옥불;지옥기운;음파;염력;
저퀴,EVIL_SPIRIT,125,95,110,130,맹렬한 갈기를 휘날리며 분노의 기운을 뿜어낸다,망령의눈빛;강철꼬리치기;사념의박치기;분노의주먹;정신집중;틈속의손
청색구인,EVIL_SPIRIT,125,115,130,110,푸른 불꽃으로 영혼을 태우는 수호의 악령이다,불꽃치기;용암분출;따라붙는불꽃;망령의눈빛;새벽의속삭임;정신집중
"""

    # 두 번째 요괴 데이터
    text2 = """
총각귀신,GHOST,130,110,110,120,죽지 못하고 떠도는 처절한 원귀,괴성; 그림자발바닥; 망령의눈빛; 안개; 음파; 정전기; 검은연기;
태봉 궁녀귀신,GHOST,120,100,125,110,궁녀의 원한이 깃들어 은인의 후손을 찾아 헤매는 원혼,괴성; 망령의눈빛; 안개; 음파; 검은연기; 영혼폭포; 혼령의숨;
태자귀,GHOST,120,90,120,110,원한을 품고 저승을 떠도는 무서운 원귀,괴성공명; 망자의손; 염력; 영혼폭포; 폭음파; 혼령의숨; 그림자베기; 달밤유성;
해중조,GHOST,115,100,120,125,바닷속 그리움으로 떠도는 수중의 원혼,음파; 정전기; 검은연못; 영혼폭포; 혼령의숨; 안개; 괴성;
홍난삼녀,GHOST,115,95,120,120,절규하는 자매 원혼이 밤길을 떠돈다,괴성공명; 망자의손; 영혼폭포; 혼령의숨; 그림자베기; 달밤유성; 암흑회오리;
개여시,ANIMAL,130,90,140,120,은밀히 다가와 영혼을 물어뜯는 개구리 몸 요괴,물기; 깨물어부수기; 숨은송곳니; 맹독침; 울부짖기; 할퀴기; 짖기; 꼬리후려치기;
계룡,ANIMAL,130,105,135,115,용과 닮은 뿔 달린 짐승이 전장을 호령한다,날개베기; 짖기; 꼬리치기; 천상질주; 호랑이눈빛; 백호의울음; 폭풍의깃;
구미호,ANIMAL,140,80,100,150,매혹적인 외모와 여우불로 적을 홀리는 전설의 요괴,유혹하기; 할퀴기; 백호의울음; 맹독침; 달빛무도; 영혼흡수; 강철꼬리치기; 숨은송곳니;
금돼지,ANIMAL,125,100,140,110,황금빛 살갗에 화염 숨을 품은 야수,불꽃치기; 맹화; 꼬리치기; 강철꼬리치기; 물기; 몸통박치기; 가시돌진; 불길장벽;
길달,ANIMAL,115,90,120,140,달빛 아래서 길을 인도하는 구슬 같은 눈을 가진 노루요괴,은신이동; 기척지우기; 바람발; 꼬리치기; 짖기; 할퀴기;
나티,ANIMAL,115,90,120,130,끝없이 헤엄치며 적을 교란하는 물귀신,음파; 폭음파; 물기; 짖기; 꼬리치기; 바람발; 유혹하기;
노구화호,ANIMAL,125,110,90,125,늙은 할머니로 둔갑하여 사람들을 현혹하는 여우 요괴,불꽃치기; 맹화; 유혹하기; 할퀴기; 짖기; 꼬리치기; 날개베기;
노호정,ANIMAL,125,110,130,115,늙은 호랑이 형상으로 호흡마다 불꽃을 내뿜는다,불꽃치기; 맹화; 강철꼬리치기; 호랑이발톱; 할퀴기; 물기; 울부짖기;
돌진;
천마,ANIMAL,110,100,110,150,옥황상제가 타던 신성한 천마로 하늘을 달리며 전장을 누비고 아군에게 희망을 안겨주는 존재,날개베기; 꼬리치기; 천상질주; 폭풍의깃; 백호의울음; 짖기; 바람발;
매기,ANIMAL,120,100,125,135,통통하게 불어나는 몸집으로 상대를 압도한다,물기; 깨물어부수기; 몸통박치기; 연속박치기; 꼬리치기; 짖기; 할퀴기;
모선출처,ANIMAL,115,95,125,135,떠도는 배 위에서 영혼을 수집하는 괴어,음파; 폭음파; 물기; 짖기; 꼬리치기; 할퀴기; 맹독침;
묘두사,ANIMAL,100,110,110,130,고양이 머리를 한 뱀으로 치유의 기운을 내뿜어 신으로 숭배되었다,물기; 울부짖기; 날개베기; 깨물어부수기; 유혹하기; 짖기; 할퀴기; 맹독침;
바람노루,ANIMAL,125,90,135,115,바람처럼 빠르게 움직이는 노루 요괴로 풀잎과 함께 달리며 적의 눈에 잘 띄지 않는다,은신이동; 기척지우기; 몸통박치기; 꼬리치기; 바람발; 짖기; 할퀴기;
백마,ANIMAL,130,115,135,120,달빛 아래에서 순백의 안개를 일으키는 성스러운 말,천상질주; 은신이동; 기척지우기; 꼬리치기; 날개베기; 짖기; 바람발;
백여우,ANIMAL,130,95,135,140,아홉 꼬리 대신 구슬 같은 불빛을 내뿜는 요괴,유혹하기; 은신이동; 짖기; 할퀴기; 물기; 꼬리치기; 독침; 바람발;
사비하대어,ANIMAL,120,105,125,115,황금 빛 비늘이 번뜩이며 적을 베어내는 사비하의 거대한 물고기,날개베기; 깨물어부수기; 꼬리후려치기; 물기; 짖기; 할퀴기; 강철꼬리치기;
삼목구,ANIMAL,120,95,125,140,세 개의 눈을 가진 개 형태의 신비한 요괴,은신이동; 잠복; 물기; 강철꼬리치기; 꼬리치기; 맹독침; 할퀴기;
삼족오,ANIMAL,125,105,130,135,태양의 사자 세 발 달린 환조,용암분출; 맹화; 날개베기; 폭풍의깃; 불사조의노래; 짖기; 할퀴기; 꼬리치기;
새우니,ANIMAL,115,85,120,140,무당이 사역하는 악귀로 질병을 퍼뜨리는 존재,은신이동; 기척지우기; 가시돌진; 꼬리치기; 짖기; 할퀴기; 물기;
선묘,ANIMAL,115,85,120,140,의상대사를 따르던 선녀이자 용으로 부석사를 수호하는 존재,은신이동; 기척지우기; 꼬리치기; 짖기; 할퀴기; 물기; 바람발;
신기원요,ANIMAL,120,100,125,135,불가사의한 빛을 내며 예지력을 부리는 신비한 귀신,염력; 유혹하기; 짖기; 할퀴기; 물기; 꼬리치기; 날개베기;
우와 을,ANIMAL,115,95,125,135,두 갈래 뿔로 불길을 가르는 야수,불꽃치기; 불길장벽; 맹화; 꼬리치기; 물기; 짖기; 할퀴기;
인면조,ANIMAL,130,85,120,145,사람 얼굴 달린 새가 육감을 이용해 적을 교란한다,날개베기; 은신이동; 기척지우기; 음파; 짖기; 할퀴기; 꼬리치기; 바람발;
청단마,ANIMAL,120,90,125,135,청동 빛 갈기를 휘날리며 달리는 신성마,은신이동; 날개베기; 꼬리치기; 짖기; 할퀴기; 물기; 바람발;
토두서조,ANIMAL,130,105,140,115,토끼 머리의 새가 밤하늘을 유영하며 수호한다,날개베기; 꼬리치기; 짖기; 할퀴기; 물기; 바람발; 사슬채찍;
호문조,ANIMAL,125,90,130,140,혓바닥처럼 생긴 부리로 적의 의식을 훔친다,짖기; 할퀴기; 물기; 꼬리치기; 날개베기; 유혹하기; 독침; 바람발;
강길,HUMAN,120,110,130,105,전설 속 강가에서 물길을 지키던 수호자의 혼령,복화술; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 바람칼;
거치녀,HUMAN,125,115,135,105,목마른 자에게 접근해 숨통을 조이는 처형자,소리지르기; 후려치기; 어퍼컷; 돌던지기; 진흙던지기; 부채베기; 호미찌르기;
고관대면,HUMAN,125,135,140,100,죽어서도 높은 지위를 지키려는 옛 관리의 영혼,소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 바람칼; 쇠방울던지기;
금갑장군,HUMAN,130,140,145,90,황금 갑옷 입고 사신을 지휘하는 군장,철퇴내리치기; 파멸의망치; 분노의주먹; 무지개발차기; 칼날비; 철화살; 어퍼컷; 후려치기;
도피사의,HUMAN,140,85,110,115,도롱이 옷을 거꾸로 입은 사람의 모습을 한 괴물,몸통박치기; 후려치기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 예측공격;
두억시니,HUMAN,120,110,130,105,죽음의 진상을 외치며 나타나는 투병자의 원혼,소리지르기; 복화술; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 후려치기;
망태기 할아버지,HUMAN,100,110,130,120,망태로 어린 영혼을 채워 어둠을 기른다,납치; 그물던지기; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기;
살음도깨비,HUMAN,110,130,120,110,사람의 형상을 한 도깨비로 인간을 흉내내지만 의도를 알 수 없는 불안한 존재,짖기; 후려치기; 불꽃치기; 소리지르기; 돌던지기; 진흙던지기; 부채베기;
설공찬,HUMAN,115,105,120,125,비극적 사랑에 얽힌 백제 시인의 원혼이 노래를 부른다,복화술; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 바람칼;
왕신단지,HUMAN,130,120,140,105,왕실의 기운을 품은 성스러운 항아리,복화술; 천연두; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기;
우렁각시,HUMAN,120,100,130,115,밥 짓는 집에서 조용히 숨 쉬는 신비손,소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 바람칼; 쇠방울던지기;
일촌법사,HUMAN,115,110,130,105,마을을 지키는 수행자의 원혼이 신기를 발휘한다,복화술; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기; 바람칼;
장화홍련,HUMAN,115,120,130,105,자매의 억울함이 불꽃처럼 타올라 원혼이 되어 복수한다,불꽃치기; 지옥불; 맹화; 소리지르기; 돌던지기; 부채베기; 호미찌르기;
죽통미녀,HUMAN,120,105,125,115,죽은 자의 가죽을 뒤집어쓴 복수자,할퀴기; 괴성; 메치기; 소리지르기; 돌던지기; 진흙던지기; 부채베기;
청양,HUMAN,115,120,125,100,청룡의 기운을 받아 청명하게 깨어난 무사의 혼,복화술; 후려치기; 소리지르기; 돌던지기; 진흙던지기; 부채베기; 호미찌르기;
거구귀,EVIL_SPIRIT,110,130,110,110,거대한 입을 지녔으나 뛰어난 인물을 만나면 동자로 변해 돕는 수호 귀신,후려치기; 돌던지기; 지옥불; 지옥기운; 음파; 독꽃던지기; 돌가루; 속임수;
거악,EVIL_SPIRIT,125,95,115,130,심연에서 깨어난 악령의 목소리가 울린다,염매; 새벽의속삭임; 망령의눈빛; 원한의바람; 달그림자베기; 망각의노래; 환영술;
견상여야록,EVIL_SPIRIT,120,115,125,105,개의 모습을 한 들사슴 같은 괴수로 백제 멸망을 예고한 존재,새벽의속삭임; 지옥기운; 염력; 괴성; 망령의눈빛; 폭음파; 귀신의사슬; 달빛무도;
구렁덩덩 선비,EVIL_SPIRIT,115,125,130,95,담비와 어울려 검을 지키는 미친 선비,후려치기; 돌던지기; 몸통박치기; 맹독침; 독꽃던지기; 돌가루; 속임수;
구반귀,EVIL_SPIRIT,105,135,115,115,밤마다 구불구불한 산길에서 나타나는 귀신,잠복; 기척지우기; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 헛소리; 환영분열;
귀마왕,EVIL_SPIRIT,135,120,140,100,천공을 가르는 마왕의 원혼이 군림한다,지옥불; 사념의박치기; 영혼착취; 염매; 지옥기운; 지옥폭뢰; 피눈물베기; 혼돈의폭발; 어둠손길; 영혼흡수;
김녕사굴 구렁이,EVIL_SPIRIT,125,100,135,110,암흑의 동굴 속 맺힌 악한 기운의 화신,혼령메아리; 어둠손길; 새벽의속삭임; 괴성; 망령의눈빛; 독꽃던지기; 돌가루; 귀신의사슬;
나군파,EVIL_SPIRIT,125,120,130,110,어우야담에 등장하는 거대한 뱀,짖기; 영혼착취; 사념의박치기; 원한의바람; 독꽃던지기; 돌가루; 속임수; 망각의노래;
녹족부인,EVIL_SPIRIT,120,130,125,100,을지문덕 장군과 관련된 고구려 시대의 여인으로 용감하게 싸웠던 인물,영혼압박; 새벽의속삭임; 어둠손길; 혼령메아리; 독꽃던지기; 돌가루; 속임수; 요상한바람;
달귀,EVIL_SPIRIT,120,110,100,140,어둠 속에 숨어 그림자에 깃들어 사람의 혼을 갉아먹는 악귀,잠복; 어둠손길; 기척지우기; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 그림자베기;
대선사사,EVIL_SPIRIT,115,125,95,120,과부에게 꿈 속에서 나타나 희롱하는 마물,잠복; 새벽의속삭임; 어둠손길; 영혼압박; 독꽃던지기; 돌가루; 속임수; 환영술;
려여귀,EVIL_SPIRIT,125,95,120,130,전염병의 고통을 퍼뜨리는 무서운 전염의 화신,염매; 혼령메아리; 어둠손길; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 망각의노래;
마귀,EVIL_SPIRIT,125,95,100,130,형체도 불분명한 사악한 기운의 집합체로 사람의 정신을 갉아먹는 존재,영혼착취; 어둠손길; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 헛소리;
무수대망,EVIL_SPIRIT,130,115,140,105,수많은 원혼을 거느린 혼의 군단장,영혼착취; 사념의박치기; 새벽의속삭임; 폭음파; 지옥기운; 지옥불; 지옥폭뢰; 혼돈의폭발;
문경관,EVIL_SPIRIT,120,110,130,100,허공에서 목소리만 들려오는 신비체,새벽의속삭임; 염력; 기척지우기; 어둠손길; 망령의눈빛; 독꽃던지기; 돌가루; 속임수;
산귀,EVIL_SPIRIT,125,105,135,105,사찰에 숨어 불공을 빼앗는 속임수 귀신,새벽의속삭임; 영혼착취; 어둠손길; 독꽃던지기; 돌가루; 속임수; 헛소리; 환영술;
삼기호신,EVIL_SPIRIT,130,125,140,100,삼기산의 여우신으로 높은 도력과 예지력을 가진 존재,사념의박치기; 망령의눈빛; 새벽의속삭임; 괴성; 독꽃던지기; 돌가루; 속임수; 환영분열;
성성,EVIL_SPIRIT,130,120,140,100,밤하늘 별빛으로 맺은 수호의 영혼,새벽의속삭임; 망령의눈빛; 사념의박치기; 괴성; 염력; 영혼압박; 독꽃던지기; 돌가루;
손님,EVIL_SPIRIT,135,120,140,115,천연두신의 위엄을 품고 재앙을 불러오는 무서운 신령,천연두; 염매; 혼령메아리; 망령의눈빛; 지옥기운; 지옥불; 지옥폭뢰; 피눈물베기; 영혼흡수;
신록,EVIL_SPIRIT,125,115,135,105,초록 빛 생명력이 악령에 스며들었다,염력; 영혼압박; 새벽의속삭임; 혼령메아리; 기척지우기; 폭음파; 독꽃던지기; 돌가루;
우투리,EVIL_SPIRIT,125,115,135,110,공중을 날며 국가를 위협한 신생 전사,사념의박치기; 영혼압박; 독꽃던지기; 돌가루; 속임수; 헛소리; 괴성공명; 귀신의사슬;
어둑시니,EVIL_SPIRIT,125,95,120,130,어둠의 기운을 머금고 사람의 정신을 잡아먹는다,망령의눈빛; 사념의박치기; 어둠손길; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 환영술;
이수약우,EVIL_SPIRIT,125,90,115,130,소와 비슷한 형상을 한 이상한 짐승으로 재앙을 내리는 백우의 혼령,혼령메아리; 망령의눈빛; 폭음파; 새벽의속삭임; 염매; 독꽃던지기; 돌가루; 속임수;
장자마리,EVIL_SPIRIT,120,120,110,100,강릉 지역 도깨비로 풍요와 혼돈을 상징하는 익살스러운 존재,불꽃치기; 지옥기운; 지옥불; 음파; 염력; 독꽃던지기; 돌가루; 속임수;
저퀴,EVIL_SPIRIT,125,95,110,130,맹렬한 갈기를 휘날리며 분노의 기운을 뿜어낸다,망령의눈빛; 사념의박치기; 분노의주먹; 독꽃던지기; 돌가루; 속임수; 헛소리; 귀신의사슬;
청색구인,EVIL_SPIRIT,125,115,130,110,푸른 불꽃으로 영혼을 태우는 수호의 악령,불꽃치기; 용암분출; 망령의눈빛; 새벽의속삭임; 독꽃던지기; 돌가루; 속임수; 헛소리;

 """

    # 데이터 파싱
    df1 = parse_yokai_data(text1)
    df2 = parse_yokai_data(text2)
    
    # 비교
    result_df = compare_yokai(df1, df2)
    
    # 결과 저장
    save_to_excel(result_df, "요괴_비교_결과.xlsx")

if __name__ == "__main__":
    main() 